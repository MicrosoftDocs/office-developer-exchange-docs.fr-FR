---
title: Exportation et importation d’éléments à l’aide d’EWS dans Exchange
manager: sethgros
ms.date: 03/9/2015
ms.audience: Developer
ms.assetid: ad5f75f9-47c3-4f51-a535-80cba4243683
description: Découvrez comment exporter et importer des rendez-vous, des courriers électroniques, des contacts, des tâches et d’autres éléments de boîte aux lettres à l’aide de l’API managée EWS ou EWS dans Exchange.
localization_priority: Priority
ms.openlocfilehash: 1bd36cec5c26f79de96b1506a52d297d2edc051a
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/03/2020
ms.locfileid: "44528418"
---
# <a name="exporting-and-importing-items-by-using-ews-in-exchange"></a>Exportation et importation d’éléments à l’aide d’EWS dans Exchange

Découvrez comment exporter et importer des rendez-vous, des courriers électroniques, des contacts, des tâches et d’autres éléments de boîte aux lettres à l’aide de l’API managée EWS ou EWS dans Exchange. 
  
Exchange est une mine d’or d’informations importantes : les messages électroniques, les contacts, les tâches et les calendriers sont essentiels pour les fonctions d’une organisation. EWS vous permet d’exporter et d’importer des types d’éléments principaux à l’aide de trois approches différentes :
  
- Types d’éléments Exchange. Cette approche est recommandée pour l’importation et l’exportation d’éléments vers et à partir d’autres systèmes et fichiers.
    
- Fonctionnalité au niveau de l’élément (EWS uniquement). Nous vous recommandons d’utiliser cette option pour exporter ou copier à partir d’un serveur ou d’une boîte aux lettres Exchange et de les importer vers un autre.
    
- Flux MIME sous la forme de formats de fichier standard courants, tels que iCalendar et vCard. Étant donné que le jeu de propriétés est limité et que la conversion MIME est coûteuse, nous vous recommandons de l’utiliser uniquement pour importer ou exporter une petite quantité de données.
    
> [!IMPORTANT]
> EWS n’est pas conçu pour la sauvegarde et la restauration de boîtes aux lettres. Pour sauvegarder et restaurer des bases de données, utilisez l' [API de sauvegarde et de restauration](../backup-restore/backup-and-restore-for-exchange-2013.md). Voir aussi [sauvegarde, restauration et récupération d’urgence](https://technet.microsoft.com/library/dd876874%28v=exchg.150%29.aspx) sur TechNet. 
  
**Tableau 1. Exportation et importation d’éléments de contacts, de messagerie et de calendrier**

|Tâche|Méthode d’API managée EWS|Opération EWS|Notes|
|:-----|:-----|:-----|:-----|
|Exporter une copie d’un contact, d’un message électronique, d’une tâche ou d’un élément de calendrier avec un [jeu de propriétés spécifié](properties-and-extended-properties-in-ews-in-exchange.md).  <br/> |[Contact. bind](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.contact.bind%28v=exchg.80%29.aspx) <br/> [EmailMessage. bind](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.emailmessage.bind%28v=exchg.80%29.aspx) <br/> [Rendez-vous. bind](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.appointment.bind%28v=exchg.80%29.aspx) <br/> [Task. bind](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.task.bind%28v=exchg.80%29.aspx) <br/> |[GetItem](https://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) <br/> |Nous vous recommandons cette option si vous exportez des éléments de boîte aux lettres vers un autre système ou fichier non-Exchange (y compris les types de fichiers vCard et iCal).<br/>Étant donné que vous contrôlez le jeu de propriétés exportées et que les performances sont meilleures pour le serveur Exchange, il s’agit généralement de la meilleure option.<br/><br/>En fonction des propriétés définies sur un élément de boîte aux lettres et si votre application reconnaît tous les identificateurs de propriété non schématisées (propriétés étendues) susceptibles d’être définis sur un élément, cette option peut ne pas produire de copie de fidélité complète.<br/><br/>Ces méthodes et opérations fournissent le jeu schématisées de propriétés pour un élément, ainsi que toutes les propriétés étendues demandées.<br/>La méthode **Bind** ou l’opération **GetItem** peut fournir uniquement une exportation de fidélité des éléments uniquement si vous avez connaissance des propriétés étendues définies sur un élément.<br/>Vous pouvez demander toutes les [propriétés étendues](properties-and-extended-properties-in-ews-in-exchange.md) connues pour activer la fidélité totale.<br/><br/>**Conseil**: vous pouvez utiliser la fonctionnalité de suivi dans l’API managée EWS pour obtenir la représentation XML des éléments exportés.           Pour plus d’informations, consultez [la rubrique Exporter un élément dans un format personnalisé](how-to-export-items-by-using-ews-in-exchange.md#bk_exportcustom).  <br/> |
|Importer une copie d’un contact, d’un message électronique, d’une tâche ou d’un élément de calendrier avec un [jeu de propriétés spécifié](properties-and-extended-properties-in-ews-in-exchange.md).  <br/> |[Contact. Save](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.contact.save%28v=exchg.80%29.aspx) <br/> [EmailMessage. Save](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.emailmessage.save%28v=exchg.80%29.aspx) <br/> [Appointment.Save](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.appointment.save%28v=exchg.80%29.aspx) <br/> [Task. Save](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.task.save%28v=exchg.80%29.aspx) <br/> |[CreateItem](https://msdn.microsoft.com/library/78a52120-f1d0-4ed7-8748-436e554f75b6%28Office.15%29.aspx) <br/> |Nous vous recommandons d’utiliser cette option pour importer des éléments de boîte aux lettres dans Exchange.<br/>Vous devrez peut-être définir des propriétés spéciales sur certains types d’éléments afin de conserver l’état de l’élément importé.<br/>Étant donné que certaines propriétés sont définies uniquement par Exchange et non par les clients, il n’est pas toujours possible d’avoir une importation de fidélité totale.<br/><br/>Par exemple, vous ne pouvez pas importer une réunion avec des participants dans une boîte aux lettres car Exchange définit les relations entre l’organisateur et les participants. <br/>Cette relation ne peut être établie que par les organisateurs envoyant et attendant des destinataires et en répondant à la demande de réunion.<br/><br/>Les objets de **rendez-vous** dans Exchange peuvent avoir des relations et des paramètres complexes.<br/> Les rendez-vous qui ont des participants (réunions) ont des paramètres qui lient l’organisateur de la réunion et les participants à la réunion.<br/>Ces paramètres ne sont pas conservés lorsque vous exportez et importez des rendez-vous.<br/>La rétabliage par programme des relations d’organisateur de réunions/de participant directement sur les rendez-vous n’est pas prise en charge.<br/>Une des options dont vous disposez pour rétablir ces relations consiste à effectuer un post-traitement après une importation, puis à demander à un organisateur de renvoyer les réunions et à ce que les participants acceptent les réunions.<br/>Vous pouvez utiliser l’emprunt d’identité Exchange pour effectuer les appels pour l’organisateur et les participants.<br/>Vous devez modifier la propriété UID de l’objet de **rendez-** vous avant l’importation pour éviter que des réunions ne soient liées correctement à d’autres réunions dans une boîte aux lettres.  <br/> |
|Exporter une copie d’un contact, d’un message électronique, d’une tâche ou d’un élément de calendrier dans une fidélité optimale.  <br/> |Non applicable  <br/> |[ExportItems](https://msdn.microsoft.com/library/e2846abb-0b16-4732-bbd8-038a674672f6%28Office.15%29.aspx) <br/> |Il s’agit de la meilleure option pour exporter les éléments de boîte aux lettres que vous souhaitez importer vers une boîte aux lettres Exchange.<br/>Vous pouvez également utiliser cette option pour copier des éléments entre des boîtes aux lettres.<br/><br/>L’opération **ExportItems** fournit un flux opaque qui représente l’élément que vous pouvez utiliser pour déplacer des informations entre des boîtes aux lettres.<br/>Vous pouvez utiliser **ExportItems** avec l’opération [GetItem](https://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) pour créer un index pour trouver les éléments d’un autre système.<br/>Vous ne pouvez pas modifier le flux d’exportation.  <br/> Pour plus d’informations, consultez la rubrique [Export items with full Fidelity](how-to-export-items-by-using-ews-in-exchange.md#bk_exportfullfidelity).  <br/> |
|Importer une copie d’un contact, d’un message électronique, d’une tâche ou d’un élément de calendrier en fidélité totale.  <br/> |Non applicable  <br/> |[UploadItems](https://msdn.microsoft.com/library/a88cbe99-7968-454d-a545-4f92c330909f%28Office.15%29.aspx) <br/> |Il s’agit de la seule option pour importer des éléments qui ont été exportés par l’opération **ExportItems** .  <br/> |
|Exporter une copie d’un contact, d’un message électronique ou d’un élément de calendrier en tant que flux MIME pour un type de fichier commun.  <br/> |[Contact. bind](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.contact.bind%28v=exchg.80%29.aspx) <br/> [EmailMessage. bind](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.emailmessage.bind%28v=exchg.80%29.aspx) <br/> [Rendez-vous. bind](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.appointment.bind%28v=exchg.80%29.aspx) <br/> |**GetItem** <br/> |Vous pouvez utiliser la propriété [lamimecontent](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.mimecontent%28v=exchg.80%29.aspx) pour obtenir la représentation MIME Stream d’un élément.<br/><br/>Cette opération fournit un sous-ensemble de base de toutes les propriétés d’un élément.<br/>Il est recommandé d’utiliser uniquement le flux MIME pour les opérations ponctuelles.<br/>Ne comptez pas sur MIME pour l’importation/exportation des éléments à grande et fréquente, car Exchange effectue une conversion de contenu pour le format MIME, ce qui peut affecter les performances.<br/><br/>Le flux MIME de **contact** est un fichier [vCard](http://www.faqs.org/rfcs/rfc2426.html) (. vcf).<br/>En fonction des propriétés définies sur un contact, il se peut que cela ne génère pas de copie de fidélité complète.<br/>Notez que vous ne pouvez pas importer un contact à l’aide du flux MIME vCard.<br/>Pour en savoir plus, consultez la rubrique [exporter un contact dans un fichier vCard](how-to-export-items-by-using-ews-in-exchange.md#bk_exportvcardmime).<br/><br/>Le flux MIME **EmailMessage** est un fichier. eml.<br/>Le format. eml est pratique, car Outlook et d’autres clients de messagerie peuvent l’identifier.<br/>Vous pouvez également utiliser le flux MIME pour créer un fichier. mht, ce qui est pratique, car de nombreux navigateurs peuvent utiliser ce type de fichier.<br/>EWS ne fournit pas de flux de fichier. msg pour l’exportation d’un message électronique dans un fichier. msg.<br/>Vos options pour l’exportation d’un fichier. MSG doivent [créer un. Fichier MSG](https://msdn.microsoft.com/library/cc463912%28v=EXCHG.80%29.aspx) à partir des résultats d’une méthode **EmailMessage. bind** ou d’une opération **GETITEM** ou utiliser une API tierce qui appelle EWS et crée le fichier. MSG à partir des résultats.<br/>Pour plus d’informations, consultez la rubrique [exporter un message électronique en tant que fichier. eml](how-to-export-items-by-using-ews-in-exchange.md#bk_exportemailmime).<br/><br/>Le flux MIME de **rendez-vous** est un fichier iCal (. ICS).<br/>Le format. ICS est pratique, car Outlook et d’autres clients de messagerie peuvent l’identifier.<br/>Il ne s’agit pas d’une option viable pour l’exportation de réunions, car les informations des participants ne sont pas fournies dans le flux MIME. <br/>Les pièces jointes et d’autres propriétés ne sont pas incluses dans le flux MIME.<br/>Envisagez de créer le format iCal à partir de l’objet appointment [ou du code](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.appointment%28v=exchg.80%29.aspx) XML renvoyé par l’opération **GetItem** .<br/>De cette façon, vous pouvez capturer davantage de propriétés Exchange avec des propriétés étendues (« X ») dans le fichier iCal.<br/>Vous pouvez également exporter un rendez-vous au format XML.<br/>Appelez l’opération **GetItem** et enregistrez le XML dans votre système.<br/>Vous pouvez également utiliser la [fonctionnalité de suivi](how-to-trace-requests-responses-to-troubleshoot-ews-managed-api-applications.md) dans l’API managée EWS pour capturer le code XML à placer dans une base de données XML.<br/>Pour plus d’informations, consultez la rubrique [exportation d’un rendez-vous sous la forme d’un fichier iCal](how-to-export-items-by-using-ews-in-exchange.md#bk_exporticalmime).  <br/> |
|Importer une copie d’un courrier électronique ou d’un élément de calendrier en tant que flux MIME pour un type de fichier commun.  <br/> |[EmailMessage. Save](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.emailmessage.save%28v=exchg.80%29.aspx) <br/> [Appointment.Save](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.appointment.save%28v=exchg.80%29.aspx) <br/> |**CreateItem** <br/> |Vous pouvez importer un fichier. **eml ou.** ICS à l’aide de la propriété **lamimecontent** sur un objet **EmailMessage** ou appointment.<br/>Vous devrez définir la propriété étendue [PidTagMessageFlags (0x0E07)](https://msdn.microsoft.com/library/office/cc839733%28v=office.15%29.aspx) si le message électronique n’est pas un brouillon.<br/><br/>Vous ne pouvez pas utiliser cette méthode pour importer des réunions.  <br/> |
   
## <a name="alternatives-to-exporting-and-importing-items-by-using-ews"></a>Alternatives à l’exportation et à l’importation d’éléments à l’aide d’EWS
<a name="alternatives"> </a>

D’autres options sont disponibles pour exporing et l’importation d’éléments vers et à partir d’une boîte aux lettres Exchange. Voici quelques idées à prendre en compte lors de la conception de votre stratégie d’importation et d’exportation :
  
- Utilisez PowerShell pour appeler EWS et mettre en forme la sortie dans un fichier. csv.
    
- Utiliser des bibliothèques tierces qui implémentent MAPI pour exporter et importer des éléments. Les bibliothèques tierces qui convertissent EWS en fichiers. MSG sont également disponibles.
    
- Utilisez l’environnement de commande Exchange Management Shell et les applets de commande [MailboxImportRequest](https://technet.microsoft.com/library/ff607310%28v=exchg.150%29.aspx) et [MailboxExportRequest](https://technet.microsoft.com/library/ff607299%28v=exchg.150%29.aspx) pour [répondre aux demandes d’importation et d’exportation de boîte aux lettres](https://technet.microsoft.com/library/ee633455%28v=exchg.150%29.aspx). 
    
- Utiliser les [options d’importation d’Outlook](https://office.microsoft.com/outlook-help/import-outlook-items-from-an-outlook-data-file-pst-HA102505743.aspx) pour importer et exporter des éléments. 

    
## <a name="in-this-section"></a>Dans cette section
<a name="alternatives"> </a>

- [Exporter des éléments à l’aide d’EWS dans Exchange](how-to-export-items-by-using-ews-in-exchange.md)    
- [Importer des éléments à l’aide d’EWS dans Exchange](how-to-import-items-by-using-ews-in-exchange.md)
    
## <a name="see-also"></a>Voir aussi

- [Sauvegarde, restauration et récupération d’urgence](https://technet.microsoft.com/library/dd876874%28v=exchg.150%29.aspx)  
- [Journalisation](https://technet.microsoft.com/library/aa998649%28v=exchg.150%29.aspx)    
- [Spécification de l’objet principal de planification et de calendrier Internet (RFC 5545)](http://tools.ietf.org/html/rfc5545)   
- [Synchronisation de la boîte aux lettres et les services EWS d'Exchange](mailbox-synchronization-and-ews-in-exchange.md)
    