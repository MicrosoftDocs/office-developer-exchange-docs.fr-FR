---
title: Exporter et importer des éléments à l’aide de EWS dans Exchange
manager: sethgros
ms.date: 03/9/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: ad5f75f9-47c3-4f51-a535-80cba4243683
description: Découvrez comment exporter et importer les rendez-vous, les messages électroniques, contacts, tâches et autres éléments de boîte aux lettres à l’aide de l’API managée EWS ou EWS dans Exchange.
ms.openlocfilehash: 63ba8807dd63ca2d151b1c2b1277625daeed640c
ms.sourcegitcommit: 34041125dc8c5f993b21cebfc4f8b72f0fd2cb6f
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19754793"
---
# <a name="exporting-and-importing-items-by-using-ews-in-exchange"></a>Exporter et importer des éléments à l’aide de EWS dans Exchange

Découvrez comment exporter et importer les rendez-vous, les messages électroniques, contacts, tâches et autres éléments de boîte aux lettres à l’aide de l’API managée EWS ou EWS dans Exchange. 
  
Exchange est une véritable mine d’informations importantes : courrier, contacts, tâches et des calendriers sont les principaux aux fonctions d’une organisation. EWS permet d’exporter et importer des types d’éléments principaux par le biais des trois approches différentes :
  
- Types d’élément Exchange. Nous vous recommandons cette approche pour importer et exporter des éléments vers ou à partir d’autres systèmes et de fichiers.
    
- Au niveau élément capability (EWS uniquement). Nous vous recommandons cette option pour l’exportation ou copie d’une boîte aux lettres ou d’Exchange server et importation vers un autre.
    
- Flux de données MIME sous la forme de des formats de fichier standard courants tels qu’iCalendar et vCard. Étant donné que le jeu de propriétés est limité et conversion MIME est coûteuse, nous vous recommandons de l’approche que pour l’importation ou l’exportation d’une petite quantité de données.
    
> [!IMPORTANT]
> EWS n’est pas conçu pour la sauvegarde de boîte aux lettres et de restauration. Pour sauvegarder et restaurer des bases de données, utilisez l' [API de sauvegarde et de restauration](../backup-restore/backup-and-restore-for-exchange-2013.md). Voir aussi [sauvegarde, restauration et récupération d’urgence](http://technet.microsoft.com/en-us/library/dd876874%28v=exchg.150%29.aspx) sur TechNet. 
  
**Le tableau 1. Exportation et importation de contacts, email et éléments de calendrier**

|**Tâche**|**Méthode d'API managée EWS**|**Opération EWS**|**Remarques**|
|:-----|:-----|:-----|:-----|
|Exporter une copie d’un contact, courrier électronique, tâche ou élément de calendrier avec une [valeur de propriété spécifiée](properties-and-extended-properties-in-ews-in-exchange.md).  <br/> |[Contact.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.contact.bind%28v=exchg.80%29.aspx) <br/> [EmailMessage.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.emailmessage.bind%28v=exchg.80%29.aspx) <br/> [Appointment.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.appointment.bind%28v=exchg.80%29.aspx) <br/> [Task.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.task.bind%28v=exchg.80%29.aspx) <br/> |[GetItem](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) <br/> |Nous vous recommandons cette option si vous êtes exportation d’éléments de boîte aux lettres vers un autre système non-Exchange ou de fichiers (y compris la carte de visite et les types de fichiers iCal). Étant donné que vous contrôlez le jeu de propriétés exporté et étant donné que les performances sont meilleures pour le serveur Exchange, il s’agit généralement la meilleure option.  <br/> Selon les propriétés définies dans un élément de boîte aux lettres, et si votre application a connaissance de tous les identificateurs de propriété non schématisé (propriétés étendues) qui peuvent être définis sur un élément, cette option peut ne pas produire une copie de haute fidélité.  <br/> Ces méthodes et l’opération de fournissent le jeu de propriétés pour un élément ainsi que toutes les propriétés étendues demandées schématisé. La méthode **Bind** ou **GetItem** operation ne peut fournir fidèle exportation d’éléments si vous connaissez les propriétés étendues sont définies sur un élément. Vous pouvez demander toutes les connus [les propriétés étendues](properties-and-extended-properties-in-ews-in-exchange.md) pour activer la fidélité.  <br/> > [!TIP]> Vous pouvez utiliser la fonctionnalité de suivi dans l’API managée EWS pour obtenir la représentation XML des éléments exportés.           Pour plus d’informations, voir [Exporter un élément dans un format personnalisé](how-to-export-items-by-using-ews-in-exchange.md#bk_exportcustom).  <br/> |
|Importer une copie d’un contact, courrier électronique, tâche ou élément de calendrier avec une [valeur de propriété spécifiée](properties-and-extended-properties-in-ews-in-exchange.md).  <br/> |[Contact.Save](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.contact.save%28v=exchg.80%29.aspx) <br/> [EmailMessage.Save](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.emailmessage.save%28v=exchg.80%29.aspx) <br/> [Appointment.Save](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.appointment.save%28v=exchg.80%29.aspx) <br/> [Task.Save](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.task.save%28v=exchg.80%29.aspx) <br/> |[CreateItem](http://msdn.microsoft.com/library/78a52120-f1d0-4ed7-8748-436e554f75b6%28Office.15%29.aspx) <br/> |Nous vous recommandons cette option pour importer des éléments de boîte aux lettres dans Exchange. Vous devrez peut-être définir des propriétés spéciales sur certains types d’éléments afin de maintenir l’état de l’élément importé. Étant donné que certaines propriétés sont définies uniquement par Exchange, et pas par les clients, il n’est pas toujours possible d’avoir une importation fidèle.  <br/> Par exemple, vous ne pouvez pas importer une réunion avec les participants dans une boîte aux lettres car Exchange définit les relations entre l’organisateur et les participants. Cette relation seulement peut être établie par l’envoi des organisateurs et les participants à recevoir et de répondre à la demande de réunion.  <br/> Objets de **rendez-vous** dans Exchange peuvent avoir les paramètres et les relations complexes. Rendez-vous ayant des participants (réunions) ont des paramètres qui lient l’organisateur de la réunion et les participants à la réunion. Ces paramètres ne sont pas conservées lorsque vous exportez et importez le rendez-vous. Par programme rétablir réunion relations organisateur/participant directement suite les rendez-vous n'est pas pris en charge. Une option que vous avez pour rétablir ces relations consiste à effectuer de post-traitement après une importation, puis avoir un organisateur renvoyer les réunions et ont les participants à accepter les réunions. Vous pouvez utiliser l’emprunt d’identité Exchange pour effectuer les appels pour l’organisateur et les participants. Vous devez modifier la propriété UID de l’objet **Appointment** avant de l’importer pour éviter d’avoir des réunions être correctement liées aux autres réunions dans une boîte aux lettres.  <br/> |
|Exporter une copie d’un contact, courrier électronique, tâche ou élément de calendrier dans fidèle.  <br/> |Not applicable  <br/> |[ExportItems](http://msdn.microsoft.com/library/e2846abb-0b16-4732-bbd8-038a674672f6%28Office.15%29.aspx) <br/> |Il s’agit de la meilleure option pour l’exportation d’éléments de boîte aux lettres que vous souhaitez importer dans une boîte aux lettres Exchange. Vous pouvez également utiliser cette option pour copier des éléments entre les boîtes aux lettres. L’opération **ExportItems** fournit un flux qui représente l’élément que vous pouvez utiliser pour déplacer des informations entre des boîtes aux lettres. Vous pouvez utiliser **ExportItems** avec l’opération [GetItem](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) pour créer un index pour rechercher les éléments dans un autre système. Vous ne pouvez pas modifier le flux d’exportation.  <br/> Pour plus d’informations, voir [exporter des éléments de fidélité](how-to-export-items-by-using-ews-in-exchange.md#bk_exportfullfidelity).  <br/> |
|Importer une copie d’un contact, courrier électronique, tâche ou élément de calendrier dans fidèle.  <br/> |Not applicable  <br/> |[UploadItems](http://msdn.microsoft.com/library/a88cbe99-7968-454d-a545-4f92c330909f%28Office.15%29.aspx) <br/> |Il s’agit de la seule option pour l’importation des éléments qui ont été exportés par l’opération **ExportItems** .  <br/> |
|Exporter une copie d’un contact, un e-mail ou un élément de calendrier sous forme de chaîne MIME pour un type de fichier courantes.  <br/> |[Contact.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.contact.bind%28v=exchg.80%29.aspx) <br/> [EmailMessage.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.emailmessage.bind%28v=exchg.80%29.aspx) <br/> [Appointment.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.appointment.bind%28v=exchg.80%29.aspx) <br/> |**GetItem** <br/> |Vous pouvez utiliser la propriété [MimeContent](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.mimecontent%28v=exchg.80%29.aspx) pour obtenir la représentation sous forme de flux de données MIME d’un élément.  <br/> Il fournit un sous-ensemble de toutes les propriétés de base sur un élément. Meilleure pratique, utilisez uniquement le flux MIME pour les opérations uniques. Ne comptez pas sur MIME pour importants et fréquent importation/exportation d’éléments, car Exchange effectue la conversion de contenu pour le MIME et cela peut affecter les performances.  <br/> Le flux MIME de **Contact** est un fichier [vCard](http://www.faqs.org/rfcs/rfc2426.mdl) (.vcf). Selon les propriétés définies sur un contact, il peut ne pas produire une copie de haute fidélité. Notez que vous ne pouvez pas importer un contact à l’aide du flux MIME vCard. Pour plus d’informations, consultez la rubrique [Exporter un contact dans un fichier vCard](how-to-export-items-by-using-ews-in-exchange.md#bk_exportvcardmime).  <br/> Le flux MIME **EmailMessage** est un fichier .eml. Le format .eml est pratique car Outlook et autres clients de messagerie peuvent identifier. Vous pouvez également utiliser le flux MIME pour créer un fichier .mht, qui est très utile car de nombreux navigateurs peuvent utiliser ce type de fichier. Pour exporter un message électronique vers un fichier .msg EWS ne fournit pas un flux de fichier .msg. Les options disponibles pour l’exportation d’un fichier .msg sont à construction [un. Fichier MSG](http://msdn.microsoft.com/en-us/library/cc463912%28v=EXCHG.80%29.aspx) dans les résultats d’une méthode **EmailMessage.Bind** ou une opération de **GetItem** appeler, ou utilisez une API tierce qui appelle EWS et construit le fichier .msg à partir des résultats. Pour plus d’informations, voir [Exporter un message électronique en tant que fichier .eml](how-to-export-items-by-using-ews-in-exchange.md#bk_exportemailmime).  <br/> Le flux MIME **rendez-vous** est un fichier iCal (.ics). Le format .ics est pratique car Outlook et autres clients de messagerie peuvent identifier. Il n’est pas une option viable pour l’exportation des réunions, car les informations sur le participant ne sont pas fournies dans le flux MIME. Pièces jointes et autres propriétés ne peuvent pas être incluses dans le flux MIME. Envisagez de construire le format iCal à partir de l’objet [rendez-vous](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.appointment%28v=exchg.80%29.aspx) ou du code XML renvoyé par l’opération **GetItem** . De cette manière, vous pouvez capturer plusieurs propriétés avec des propriétés étendues Exchange (« x » propriétés) dans le fichier iCal. Vous pouvez également exporter un rendez-vous au format XML. Appeler l’opération **GetItem** et enregistrez le fichier XML dans votre système. Vous pouvez également utiliser la [fonctionnalité de suivi](how-to-trace-requests-responses-to-troubleshoot-ews-managed-api-applications.md) dans l’API managée EWS pour capturer les données XML à placer dans une base de données XML. Pour plus d’informations, voir [exportation d’un rendez-vous au format de fichier iCal](how-to-export-items-by-using-ews-in-exchange.md#bk_exporticalmime).  <br/> |
|Importer une copie d’un élément de courrier ou calendrier sous forme de chaîne MIME pour un type de fichier courantes.  <br/> |[EmailMessage.Save](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.emailmessage.save%28v=exchg.80%29.aspx) <br/> [Appointment.Save](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.appointment.save%28v=exchg.80%29.aspx) <br/> |**CreateItem** <br/> |Vous pouvez importer un fichier .eml ou .ics à l’aide de la propriété **MimeContent** sur un objet **EmailMessage** ou **d’un rendez-vous** . Vous devez définir le [PidTagMessageFlags (0x0E07)](http://msdn.microsoft.com/en-us/library/office/cc839733%28v=office.15%29.aspx) propriété étendue si le courrier électronique n’est pas un brouillon.  <br/> Vous ne pouvez pas utiliser cette approche pour importer des réunions.  <br/> |
   
## <a name="alternatives-to-exporting-and-importing-items-by-using-ews"></a>Alternatives pour exporter et importer des éléments à l’aide de EWS
<a name="alternatives"> </a>

Autres options sont disponibles pour exporing et des éléments de l’importation vers et à partir d’une boîte aux lettres Exchange. Voici quelques idées à prendre en compte lorsque vous concevez votre importation et exportez de stratégie :
  
- Utiliser PowerShell pour appeler EWS et mettre en forme la sortie dans un fichier .csv.
    
- Utiliser des bibliothèques de tiers qui implémentent MAPI pour exporter et importer des éléments. Bibliothèques de tiers convertir EWS fichiers .msg sont trop disponibles.
    
- Utilisez les applets de commande Exchange Management Shell et [MailboxImportRequest](http://technet.microsoft.com/en-us/library/ff607310%28v=exchg.150%29.aspx) et [MailboxExportRequest](http://technet.microsoft.com/en-us/library/ff607299%28v=exchg.150%29.aspx) pour [honorer d’importation de boîte aux lettres demandes d’exportation](http://technet.microsoft.com/en-us/library/ee633455%28v=exchg.150%29.aspx). 
    
- Utilisez les [options d’importation d’Outlook](http://office.microsoft.com/en-us/outlook-help/import-outlook-items-from-an-outlook-data-file-pst-HA102505743.aspx) pour importer et exporter les éléments. 
    
## <a name="in-this-section"></a>Dans cette section
<a name="alternatives"> </a>

- [Exporter les éléments à l’aide de EWS dans Exchange](how-to-export-items-by-using-ews-in-exchange.md)
    
- [Importer des éléments à l’aide de EWS dans Exchange](how-to-import-items-by-using-ews-in-exchange.md)
    
## <a name="see-also"></a>Voir aussi


- [Sauvegarde, restauration et récupération d’urgence](http://technet.microsoft.com/en-us/library/dd876874%28v=exchg.150%29.aspx)
    
- [Journalisation](http://technet.microsoft.com/en-us/library/aa998649%28v=exchg.150%29.aspx)
    
- [Du calendrier Internet et planification de la spécification d’objet principal (RFC 5545)](http://tools.ietf.org/html/rfc5545)
    
- [Synchronisation de la boîte aux lettres et les services EWS d'Exchange](mailbox-synchronization-and-ews-in-exchange.md)
    

