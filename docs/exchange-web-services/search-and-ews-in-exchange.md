---
title: Recherche et EWS dans Exchange
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: 9fa5b836-857e-401d-9450-51e7dbc69104
description: Découvrez comment rechercher des éléments dans Exchange à l’aide de l’API managée EWS ou d’EWS.
ms.openlocfilehash: d35cc74ab2fa79530ac09256e315a780023d833b
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/03/2020
ms.locfileid: "44463835"
---
# <a name="search-and-ews-in-exchange"></a><span data-ttu-id="7ee3f-103">Recherche et EWS dans Exchange</span><span class="sxs-lookup"><span data-stu-id="7ee3f-103">Search and EWS in Exchange</span></span>

<span data-ttu-id="7ee3f-104">Découvrez comment rechercher des éléments dans Exchange à l’aide de l’API managée EWS ou d’EWS.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-104">Find out how to search for items in Exchange by using the EWS Managed API or EWS.</span></span>

<span data-ttu-id="7ee3f-105">Est présent familier ?</span><span class="sxs-lookup"><span data-stu-id="7ee3f-105">Does this sound familiar?</span></span> <span data-ttu-id="7ee3f-106">Vous commencez enfin le projet que vous avez mis en place pendant des semaines, et vous avez besoin d’informations sur le projet que votre responsable vous a envoyé par courrier électronique il y a semaines.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-106">You're finally starting that project you've been putting off for weeks, and you need information about the project that your manager sent you in email weeks ago.</span></span> <span data-ttu-id="7ee3f-107">Votre boîte de réception contient des centaines voire des milliers de messages.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-107">Your Inbox has hundreds or perhaps thousands of messages in it.</span></span> <span data-ttu-id="7ee3f-108">Que fais-tu?</span><span class="sxs-lookup"><span data-stu-id="7ee3f-108">What do you do?</span></span> <span data-ttu-id="7ee3f-109">Faites-vous défiler votre courrier électronique pour analyser chaque objet et expéditeur jusqu’à ce que vous les trouviez ?</span><span class="sxs-lookup"><span data-stu-id="7ee3f-109">Do you scroll through your email scanning each subject and sender until you find it?</span></span> <span data-ttu-id="7ee3f-110">Ou utilisez-vous la fonctionnalité de recherche de votre client de messagerie préféré pour passer rapidement à zéro sur ce dont vous avez besoin ?</span><span class="sxs-lookup"><span data-stu-id="7ee3f-110">Or do you use the search feature in your favorite email client to quickly zero in on what you need?</span></span>

<span data-ttu-id="7ee3f-111">La recherche est probablement une fonctionnalité obligatoire pour n’importe quel client de messagerie.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-111">Search is arguably a must-have feature for any email client.</span></span> <span data-ttu-id="7ee3f-112">Toutefois, la recherche peut être utilisée pour beaucoup plus qu’autoriser les utilisateurs à effectuer des recherches dans leur boîte aux lettres.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-112">But search can be used for a lot more than just enabling users to search their mailbox.</span></span> <span data-ttu-id="7ee3f-113">Votre application doit-elle traiter des rendez-vous qui se situent dans des fenêtres temporelles spécifiques ?</span><span class="sxs-lookup"><span data-stu-id="7ee3f-113">Does your app need to process appointments that fall within specific time windows?</span></span> <span data-ttu-id="7ee3f-114">Vous avez peut-être besoin de signaler toutes les tâches ayant un statut spécifique ou de déplacer tous les contacts ayant un nom de société spécifique vers un autre dossier.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-114">Maybe you need to report on all task items with a specific status, or move all contacts with a specific company name to a different folder.</span></span> <span data-ttu-id="7ee3f-115">La recherche peut vous aider à répondre à toutes ces exigences.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-115">Search can help with all of these requirements.</span></span>

## <a name="search-basics"></a><span data-ttu-id="7ee3f-116">Notions de base de la recherche</span><span class="sxs-lookup"><span data-stu-id="7ee3f-116">Search basics</span></span>
<span data-ttu-id="7ee3f-117"><a name="bk_SearchBasics"> </a></span><span class="sxs-lookup"><span data-stu-id="7ee3f-117"><a name="bk_SearchBasics"> </a></span></span>

<span data-ttu-id="7ee3f-118">L’API managée EWS et EWS proposent deux méthodes de base pour la spécification d’une recherche.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-118">The EWS Managed API and EWS offer two basic methods for specifying a search.</span></span> <span data-ttu-id="7ee3f-119">Vous pouvez utiliser un [filtre de recherche](how-to-use-search-filters-with-ews-in-exchange.md) ou une [chaîne de requête](how-to-perform-an-aqs-search-by-using-ews-in-exchange.md).</span><span class="sxs-lookup"><span data-stu-id="7ee3f-119">You can use a [search filter](how-to-use-search-filters-with-ews-in-exchange.md) or a [query string](how-to-perform-an-aqs-search-by-using-ews-in-exchange.md).</span></span> <span data-ttu-id="7ee3f-120">La méthode que vous utilisez dépend de l’intention de votre recherche.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-120">The method you use depends on the intent behind your search.</span></span>

<span data-ttu-id="7ee3f-121">**Tableau 1. Scénarios pour les filtres de recherche et les requêtes de recherche**</span><span class="sxs-lookup"><span data-stu-id="7ee3f-121">**Table 1. Scenarios for search filters and search queries**</span></span>

|<span data-ttu-id="7ee3f-122">**Si vous souhaitez...**</span><span class="sxs-lookup"><span data-stu-id="7ee3f-122">**If you want to…**</span></span>|<span data-ttu-id="7ee3f-123">**Utiliser un...**</span><span class="sxs-lookup"><span data-stu-id="7ee3f-123">**Use a…**</span></span>|<span data-ttu-id="7ee3f-124">**Remarques**</span><span class="sxs-lookup"><span data-stu-id="7ee3f-124">**Notes**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="7ee3f-125">Limiter votre recherche à une propriété spécifique ou à un ensemble de propriétés</span><span class="sxs-lookup"><span data-stu-id="7ee3f-125">Limit your search to a specific property or set of properties</span></span>  <br/> |<span data-ttu-id="7ee3f-126">Filtre de recherche</span><span class="sxs-lookup"><span data-stu-id="7ee3f-126">Search filter</span></span>  <br/> |<span data-ttu-id="7ee3f-127">Les filtres de recherche fournissent le meilleur niveau de contrôle sur les propriétés recherchées.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-127">Search filters provide the best level of control over which properties are searched.</span></span> <span data-ttu-id="7ee3f-128">Bien que les chaînes de requête puissent cibler un ensemble limité de propriétés à l’aide de la syntaxe de requête avancée (AQS), les filtres de recherche peuvent cibler n’importe quelle propriété.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-128">Although query strings can target a limited set of properties by using Advanced Query Syntax (AQS), search filters can target any property.</span></span>  <br/> |
|<span data-ttu-id="7ee3f-129">Créer des recherches avec plusieurs critères</span><span class="sxs-lookup"><span data-stu-id="7ee3f-129">Create searches with multiple criteria</span></span>  <br/> |<span data-ttu-id="7ee3f-130">Filtre de recherche</span><span class="sxs-lookup"><span data-stu-id="7ee3f-130">Search filter</span></span>  <br/> |<span data-ttu-id="7ee3f-131">Avec les filtres de recherche, plusieurs critères de recherche peuvent être associés à des opérateurs and logiques ou à des ORs, permettant des recherches comme « l’objet contient «notes de réunion » et l’expéditeur est égal à « Sadie Daniels ».</span><span class="sxs-lookup"><span data-stu-id="7ee3f-131">With search filters, multiple search criteria can be joined together with logical ANDs or ORs, allowing for searches like "subject contains 'Meeting Notes' AND sender equals 'Sadie Daniels'".</span></span> <span data-ttu-id="7ee3f-132">Bien que les chaînes de requête puissent également rejoindre plusieurs critères de recherche, elles sont limitées à l’ensemble des propriétés prises en charge par les chaînes de requête.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-132">Although query strings can also join multiple search criteria, they are limited to the set of properties supported by query strings.</span></span>  <br/> |
|<span data-ttu-id="7ee3f-133">Rechercher des propriétés personnalisées</span><span class="sxs-lookup"><span data-stu-id="7ee3f-133">Search custom properties</span></span>  <br/> |<span data-ttu-id="7ee3f-134">Filtre de recherche</span><span class="sxs-lookup"><span data-stu-id="7ee3f-134">Search filter</span></span>  <br/> |<span data-ttu-id="7ee3f-135">Les filtres de recherche peuvent cibler des propriétés personnalisées.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-135">Search filters can target custom properties.</span></span> <span data-ttu-id="7ee3f-136">Les chaînes de requête ne recherchent pas les propriétés personnalisées.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-136">Query strings do not search custom properties.</span></span>  <br/> |
|<span data-ttu-id="7ee3f-137">Effectuer une recherche de propriétés de chaîne respectant la casse</span><span class="sxs-lookup"><span data-stu-id="7ee3f-137">Perform a case sensitive search of string properties</span></span>  <br/> |<span data-ttu-id="7ee3f-138">Filtre de recherche</span><span class="sxs-lookup"><span data-stu-id="7ee3f-138">Search filter</span></span>  <br/> |<span data-ttu-id="7ee3f-139">Les recherches de chaîne de requête ne respectent pas la casse.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-139">Query string searches are not case sensitive.</span></span>  <br/> |
|<span data-ttu-id="7ee3f-140">Contrôler le mode d’imbrication lors de la recherche de propriétés de chaîne</span><span class="sxs-lookup"><span data-stu-id="7ee3f-140">Control the containment mode when searching string properties</span></span>  <br/> |<span data-ttu-id="7ee3f-141">Filtre de recherche</span><span class="sxs-lookup"><span data-stu-id="7ee3f-141">Search filter</span></span>  <br/> |<span data-ttu-id="7ee3f-142">Les recherches de chaîne de requête sont toujours des recherches de sous-chaînes.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-142">Query string searches are always substring searches.</span></span> <span data-ttu-id="7ee3f-143">Si vous devez rechercher des préfixes spécifiques ou exiger des correspondances exactes, un filtre de recherche est le meilleur choix.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-143">If you need to search for specific prefixes, or require exact matches, a search filter is the best choice.</span></span>  <br/> |
|<span data-ttu-id="7ee3f-144">Rechercher des dossiers</span><span class="sxs-lookup"><span data-stu-id="7ee3f-144">Search for folders</span></span>  <br/> |<span data-ttu-id="7ee3f-145">Filtre de recherche</span><span class="sxs-lookup"><span data-stu-id="7ee3f-145">Search filter</span></span>  <br/> |<span data-ttu-id="7ee3f-146">EWS ne prend pas en charge la recherche de dossiers avec une chaîne de requête.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-146">EWS does not support searching for folders with a query string.</span></span>  <br/> |
|<span data-ttu-id="7ee3f-147">Créer un dossier de recherche</span><span class="sxs-lookup"><span data-stu-id="7ee3f-147">Create a search folder</span></span>  <br/> |<span data-ttu-id="7ee3f-148">Filtre de recherche</span><span class="sxs-lookup"><span data-stu-id="7ee3f-148">Search filter</span></span>  <br/> |<span data-ttu-id="7ee3f-149">EWS ne prend pas en charge la création de dossiers de recherche avec une chaîne de requête.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-149">EWS does not support creating search folders with a query string.</span></span>  <br/> |
|<span data-ttu-id="7ee3f-150">Recherche dans toutes les propriétés couramment utilisées</span><span class="sxs-lookup"><span data-stu-id="7ee3f-150">Search across all commonly used properties</span></span>  <br/> |<span data-ttu-id="7ee3f-151">Chaîne de requête</span><span class="sxs-lookup"><span data-stu-id="7ee3f-151">Query string</span></span>  <br/> |<span data-ttu-id="7ee3f-152">Les chaînes de requête qui ne contiennent pas de AQS effectuent une recherche dans toutes les propriétés couramment utilisées.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-152">Query strings that do not contain AQS will search across all commonly used properties.</span></span> <span data-ttu-id="7ee3f-153">Par exemple, la valeur de chaîne de requête « Mack Chaves » renvoie tous les messages envoyés par Mack Chaves, ainsi que tous les messages dont le corps ou l’objet contient « Mack Chaves ».</span><span class="sxs-lookup"><span data-stu-id="7ee3f-153">For example, a query string value of "Mack Chaves" will return all messages sent by Mack Chaves as well as any messages that have "Mack Chaves" in the body or subject.</span></span>  <br/> |
|<span data-ttu-id="7ee3f-154">Créer une recherche basée sur une entrée utilisateur simple</span><span class="sxs-lookup"><span data-stu-id="7ee3f-154">Construct a search based on simple user input</span></span>  <br/> |<span data-ttu-id="7ee3f-155">Chaîne de requête</span><span class="sxs-lookup"><span data-stu-id="7ee3f-155">Query string</span></span>  <br/> |<span data-ttu-id="7ee3f-156">Une chaîne de requête est un bon choix pour permettre à un utilisateur final d’effectuer une recherche rapide en tapant une chaîne simple.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-156">A query string is a great choice for allowing an end user to do a quick search by typing in a simple string.</span></span> <span data-ttu-id="7ee3f-157">Étant donné qu’une recherche de chaîne de requête inclut toutes les propriétés couramment utilisées, les résultats contiendront tous les éléments qui contiennent les termes de recherche de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-157">Because a query string search includes all commonly used properties, the results will contain any items that contain the user's search terms.</span></span>  <br/> |

### <a name="using-a-search-filter"></a><span data-ttu-id="7ee3f-158">Utilisation d’un filtre de recherche</span><span class="sxs-lookup"><span data-stu-id="7ee3f-158">Using a search filter</span></span>

<span data-ttu-id="7ee3f-159">Les filtres de recherche vous offrent un large éventail d’options de recherche et le plus grand degré de contrôle sur le mode d’exécution de la recherche.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-159">Search filters give you a wide range of search options and the greatest degree of control over how the search is performed.</span></span> <span data-ttu-id="7ee3f-160">Vous pouvez utiliser des filtres de recherche pour effectuer des recherches d’égalité et de comparaison, mais vous pouvez également effectuer des recherches dans le contenu des propriétés de chaîne ou effectuer des comparaisons de masque de masques.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-160">You can use search filters to perform basic equality and comparison searches, but you can also search within the contents of string properties or do bitmask comparisons.</span></span>

<span data-ttu-id="7ee3f-161">Par exemple, vous pouvez rechercher le contenu de l’objet d’éléments à l’aide de la classe [unsearchfilter. ContainsSubstring](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.searchfilter.containssubstring%28v=exchg.80%29.aspx) dans l’API managée EWS.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-161">For example, you can search the contents of the subject of items by using the [SearchFilter.ContainsSubstring](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.searchfilter.containssubstring%28v=exchg.80%29.aspx) class in the EWS Managed API.</span></span> <span data-ttu-id="7ee3f-162">Dans cet exemple, un filtre de recherche est créé pour Rechercher l’objet de la sous-chaîne « notes de réunion », sans tenir compte de la casse.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-162">In this example, a search filter is created to search the subject for the substring "meeting notes", ignoring case.</span></span>

```cs
SearchFilter.ContainsSubstring subjectFilter = new SearchFilter.ContainsSubstring(ItemSchema.Subject,
    "meeting notes", ContainmentMode.Substring, ComparisonMode.IgnoreCase);
```

<span data-ttu-id="7ee3f-163">Vous pouvez également rechercher des propriétés personnalisées.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-163">You can also search against custom properties.</span></span> <span data-ttu-id="7ee3f-164">Dans cet exemple, la propriété personnalisée **itemIndex** fait l’objet d’une recherche de valeurs supérieures à 3.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-164">In this example, the custom property **ItemIndex** is searched for values greater than 3.</span></span>

```cs
Guid MyAppGuid = new Guid("{AA3DF801-4FC7-401F-BBC1-7C93D6498C2E}");
ExtendedPropertyDefinition customPropDefinition =
    new ExtendedPropertyDefinition(MyAppGuid, "ItemIndex", MapiPropertyType.Integer);
SearchFilter.IsGreaterThan customPropFilter =
    new SearchFilter.IsGreaterThan(customPropDefinition, 3);
```

<span data-ttu-id="7ee3f-165">Vous pouvez également combiner plusieurs filtres de recherche pour créer des recherches plus complexes.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-165">You can also combine multiple search filters to create more complex searches.</span></span> <span data-ttu-id="7ee3f-166">Par exemple, vous pouvez combiner les deux filtres précédents avec un AND logique à l’aide de la classe [unsearchfilter. élément searchfiltercollectionpour](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.searchfilter.searchfiltercollection%28v=exchg.80%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="7ee3f-166">For example, you can combine the previous two filters with a logical AND by using the [SearchFilter.SearchFilterCollection](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.searchfilter.searchfiltercollection%28v=exchg.80%29.aspx) class.</span></span>

```cs
SearchFilter.SearchFilterCollection compoundFilter =
    new SearchFilter.SearchFilterCollection(LogicalOperator.And, subjectFilter, customPropFilter);
```

### <a name="using-a-query-string"></a><span data-ttu-id="7ee3f-167">Utilisation d’une chaîne de requête</span><span class="sxs-lookup"><span data-stu-id="7ee3f-167">Using a query string</span></span>

<span data-ttu-id="7ee3f-168">Les chaînes de requête fournissent une approche différente de la recherche.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-168">Query strings provide a different approach to search.</span></span> <span data-ttu-id="7ee3f-169">Vous avez moins de contrôle sur les champs qui sont recherchés et sur la façon dont la recherche est effectuée lorsque vous utilisez une recherche de chaîne de requête.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-169">You have less control over the fields that are searched and how the search is performed when you use a query string search.</span></span> <span data-ttu-id="7ee3f-170">Il ne s’agit pas d’une mauvaise chose !</span><span class="sxs-lookup"><span data-stu-id="7ee3f-170">Not that that's a bad thing!</span></span> <span data-ttu-id="7ee3f-171">Dans certains cas, vous souhaiterez peut-être utiliser un grand plus grand filet pour parler.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-171">In some cases, you might want to cast a wider net, so to speak.</span></span>

<span data-ttu-id="7ee3f-172">Par exemple, vous pouvez rechercher « notes de réunion » à l’aide de la méthode de l’API managée EWS [ExchangeService. FindItems](https://msdn.microsoft.com/library/jj223808%28v=exchg.80%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="7ee3f-172">For example, you can search for "meeting notes" by using the [ExchangeService.FindItems](https://msdn.microsoft.com/library/jj223808%28v=exchg.80%29.aspx) EWS Managed API method.</span></span>

```cs
FindItemsResults<Item> results = service.FindItems(folder, "meeting notes", view);
```

<span data-ttu-id="7ee3f-173">Si vous comparez les résultats de cette recherche aux résultats de l’exemple de recherche **unsearchfilter. ContainsSubstring** précédemment, cette recherche contiendra plus de résultats.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-173">If you compare the results of this search to the results of the **SearchFilter.ContainsSubstring** search example earlier, this search will contain more results.</span></span> <span data-ttu-id="7ee3f-174">La recherche de filtre de recherche ne renvoie que les éléments qui ont « notes de réunion » dans l’objet, tandis que cette recherche renvoie les éléments qui ont « notes de réunion » dans l’objet, le corps et les autres champs.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-174">The search filter search will return only items that have "meeting notes" in the subject, while this search will return items that have "meeting notes" in the subject, body, and other fields.</span></span>

<span data-ttu-id="7ee3f-175">Voyons comment vous pouvez affiner la chaîne de requête pour vous rapprocher des résultats que vous voyez du filtre de recherche.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-175">Let's take a look at how you can refine the query string to get closer to the results you see from the search filter.</span></span> <span data-ttu-id="7ee3f-176">À l’aide de AQS, vous pouvez limiter votre recherche à l’objet.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-176">Using AQS, you can limit your search to the subject.</span></span>

```cs
FindItemsResults<Item> results = service.FindItems(folder, "subject:meeting notes", view);
```

<span data-ttu-id="7ee3f-177">Cette approche est plus proche, mais les résultats ne sont toujours pas les mêmes.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-177">This is closer, but the results are still not quite the same.</span></span> <span data-ttu-id="7ee3f-178">Lorsque vous utilisez une chaîne de requête avec plusieurs mots, vous obtiendrez des correspondances même si les mots ne sont pas dans l’ordre que vous spécifiez ou même s’ils ne sont pas adjacents.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-178">When you use a query string with multiple words, you will get matches even if the words are not in the order you specify, or even if they're not adjacent to each other.</span></span> <span data-ttu-id="7ee3f-179">Avec la chaîne de requête « Subject : Meeting notes », vous obtiendrez des correspondances pour les « notes de réunion », « notes de la réunion », etc.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-179">With the query string "subject:meeting notes", you will get matches for "meeting notes", "notes from the meeting", and so on.</span></span> <span data-ttu-id="7ee3f-180">Pour affiner davantage, vous pouvez encapsuler les termes de recherche entre guillemets pour indiquer que vous souhaitez uniquement cette expression.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-180">To further refine, you can wrap the search terms in double quotes to indicate that you want that phrase only.</span></span>

```cs
FindItemsResults<Item> results = service.FindItems(folder, "subject:\"meeting notes\"", view);
```

## <a name="requesting-specific-properties-in-search-results"></a><span data-ttu-id="7ee3f-181">Demande de propriétés spécifiques dans les résultats de la recherche</span><span class="sxs-lookup"><span data-stu-id="7ee3f-181">Requesting specific properties in search results</span></span>
<span data-ttu-id="7ee3f-182"><a name="bk_RequestSpecific"> </a></span><span class="sxs-lookup"><span data-stu-id="7ee3f-182"><a name="bk_RequestSpecific"> </a></span></span>

<span data-ttu-id="7ee3f-183">Par défaut, les résultats de la recherche contiendront toutes les propriétés des éléments qui correspondent à la recherche.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-183">By default, search results will contain all properties on the items that match the search.</span></span> <span data-ttu-id="7ee3f-184">Dans certains cas, il peut s’agir de ce que vous souhaitez, mais dans la plupart des cas, votre application requiert uniquement un ensemble discret de propriétés.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-184">In some cases this might be what you want, but in most cases your application only requires a discrete set of properties.</span></span> <span data-ttu-id="7ee3f-185">Dans ce cas, vous devez limiter l’ensemble des propriétés qui sont renvoyées uniquement aux propriétés dont votre application a besoin.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-185">In this case, you should limit the set of properties that are returned to only the properties your application needs.</span></span> <span data-ttu-id="7ee3f-186">Dans l’exemple suivant, la classe [objetitemview](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.itemview%28v=exchg.80%29.aspx) est utilisée pour limiter les propriétés renvoyées à l’objet, date/heure de réception et ID des éléments.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-186">In the following example, the [ItemView](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.itemview%28v=exchg.80%29.aspx) class is used to limit the returned properties to the subject, date/time received, and ID of the items.</span></span>

```cs
ItemView view = new ItemView(10);
// Creating a new PropertySet with this constructor includes
// ItemSchema.Id.
view.PropertySet = new PropertySet(ItemSchema.Subject, ItemSchema.DateTimeReceived);
```

## <a name="controlling-search-depth"></a><span data-ttu-id="7ee3f-187">Contrôle de la profondeur de recherche</span><span class="sxs-lookup"><span data-stu-id="7ee3f-187">Controlling search depth</span></span>
<span data-ttu-id="7ee3f-188"><a name="bk_SearchDepth"> </a></span><span class="sxs-lookup"><span data-stu-id="7ee3f-188"><a name="bk_SearchDepth"> </a></span></span>

<span data-ttu-id="7ee3f-189">La définition de la traversée sur la vue contrôle la profondeur et l’étendue de la recherche.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-189">Setting the traversal on the view controls the depth and scope of the search.</span></span>

<span data-ttu-id="7ee3f-190">**Tableau 2. Valeurs de parcours de recherche**</span><span class="sxs-lookup"><span data-stu-id="7ee3f-190">**Table 2. Search traversal values**</span></span>

|<span data-ttu-id="7ee3f-191">**Valeur transversale**</span><span class="sxs-lookup"><span data-stu-id="7ee3f-191">**Traversal value**</span></span>|<span data-ttu-id="7ee3f-192">**S'applique à**</span><span class="sxs-lookup"><span data-stu-id="7ee3f-192">**Applies to**</span></span>|<span data-ttu-id="7ee3f-193">**Description**</span><span class="sxs-lookup"><span data-stu-id="7ee3f-193">**Description**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="7ee3f-194">Partielle</span><span class="sxs-lookup"><span data-stu-id="7ee3f-194">Shallow</span></span>  <br/> |<span data-ttu-id="7ee3f-195">Éléments et dossiers</span><span class="sxs-lookup"><span data-stu-id="7ee3f-195">Items and Folders</span></span>  <br/> |<span data-ttu-id="7ee3f-196">Les recherches superficielles sont limitées aux enfants directs du dossier recherché.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-196">Shallow searches are limited to direct children of the folder being searched.</span></span>  <br/> |
|<span data-ttu-id="7ee3f-197">Développée</span><span class="sxs-lookup"><span data-stu-id="7ee3f-197">Deep</span></span>  <br/> |<span data-ttu-id="7ee3f-198">Éléments (uniquement avec les dossiers de recherche) et dossiers</span><span class="sxs-lookup"><span data-stu-id="7ee3f-198">Items (only with search folders) and Folders</span></span>  <br/> |<span data-ttu-id="7ee3f-199">Les recherches approfondies effectuent une recherche de manière récursive dans le dossier recherché et ses sous-dossiers.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-199">Deep searches recursively search the folder being searched and subfolders.</span></span>  <br/> |
|<span data-ttu-id="7ee3f-200">Associé à</span><span class="sxs-lookup"><span data-stu-id="7ee3f-200">Associated</span></span>  <br/> |<span data-ttu-id="7ee3f-201">Éléments</span><span class="sxs-lookup"><span data-stu-id="7ee3f-201">Items</span></span>  <br/> |<span data-ttu-id="7ee3f-202">Les recherches associées incluent uniquement les éléments associés à partir du dossier recherché.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-202">Associated searches only include associated items from the folder being searched.</span></span> <span data-ttu-id="7ee3f-203">Les éléments associés sont des éléments masqués dans le dossier.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-203">Associated items are hidden items within the folder.</span></span>  <br/> |
|<span data-ttu-id="7ee3f-204">SoftDeleted</span><span class="sxs-lookup"><span data-stu-id="7ee3f-204">SoftDeleted</span></span>  <br/> |<span data-ttu-id="7ee3f-205">Éléments et dossiers</span><span class="sxs-lookup"><span data-stu-id="7ee3f-205">Items and Folders</span></span>  <br/> |<span data-ttu-id="7ee3f-206">Ce type de parcours est déconseillé.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-206">This traversal type is deprecated.</span></span> <span data-ttu-id="7ee3f-207">Les recherches SoftDeleted incluent uniquement les éléments qui se trouvent dans la benne.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-207">SoftDeleted searches only include items that are in the dumpster.</span></span> <span data-ttu-id="7ee3f-208">La benne a été remplacée par le [dossier éléments récupérables](https://docs.microsoft.com/exchange/policy-and-compliance/recoverable-items-folder/recoverable-items-folder) dans Exchange Online, Exchange Online dans le cadre d’Office 365 et les versions d’Exchange à partir d’Exchange 2010.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-208">The dumpster has been replaced by the [Recoverable Items Folder](https://docs.microsoft.com/exchange/policy-and-compliance/recoverable-items-folder/recoverable-items-folder) in Exchange Online, Exchange Online as part of Office 365, and versions of Exchange starting with Exchange 2010.</span></span>  <br/> |

## <a name="managing-search-results"></a><span data-ttu-id="7ee3f-209">Gestion des résultats de recherche</span><span class="sxs-lookup"><span data-stu-id="7ee3f-209">Managing search results</span></span>
<span data-ttu-id="7ee3f-210"><a name="bk_ManageSearchResults"> </a></span><span class="sxs-lookup"><span data-stu-id="7ee3f-210"><a name="bk_ManageSearchResults"> </a></span></span>

<span data-ttu-id="7ee3f-211">L’API managée EWS et EWS vous permettent également de modifier la façon dont les résultats de la recherche sont renvoyés.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-211">The EWS Managed API and EWS also allow you to change how your search results are returned.</span></span> <span data-ttu-id="7ee3f-212">Vous pouvez utiliser les affichages pour spécifier les propriétés à inclure dans les résultats, trier les résultats et pager vos résultats pour obtenir uniquement un nombre défini de résultats par réponse.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-212">You can use views to specify which properties are included in the results, sort results, and page your results to only get back a set number of results per response.</span></span> <span data-ttu-id="7ee3f-213">Vous pouvez également regrouper les résultats par valeurs de champ spécifiques et contrôler la profondeur d’une recherche en spécifiant un type de parcours.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-213">You can also group results by specific field values and control the depth of a search by specifying a traversal type.</span></span> <span data-ttu-id="7ee3f-214">Enfin, vous pouvez utiliser les dossiers de recherche pour créer des recherches permanentes qui sont mises à jour dynamiquement à l’arrivée de nouveaux éléments.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-214">Finally, you can use search folders to create persistent searches that are updated dynamically as new items arrive.</span></span>

### <a name="sorting"></a><span data-ttu-id="7ee3f-215">Tri</span><span class="sxs-lookup"><span data-stu-id="7ee3f-215">Sorting</span></span>

<span data-ttu-id="7ee3f-216">Vous pouvez faire en sorte que le serveur renvoie des résultats triés, ce qui permet d’afficher ou de traiter plus facilement les éléments dans l’ordre.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-216">You can get the server to return sorted results, which can make it easier to display or process items in order.</span></span> <span data-ttu-id="7ee3f-217">Dans cet exemple, les résultats sont triés par date/heure de réception, avec les éléments les plus récents en premier.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-217">In this example, the results will be sorted by the date/time received, with the newest items being first.</span></span>

```cs
view.OrderBy.Add(ItemSchema.DateTimeReceived, SortDirection.Descending);
```

### <a name="paging"></a><span data-ttu-id="7ee3f-218">Pagination</span><span class="sxs-lookup"><span data-stu-id="7ee3f-218">Paging</span></span>

<span data-ttu-id="7ee3f-219">Lorsque vous envoyez une demande de recherche à l’aide de l’API managée EWS ou EWS, vous spécifiez une taille d’affichage, qui contrôle le nombre maximal d’éléments renvoyés.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-219">When you send a search request by using the EWS Managed API or EWS, you specify a view size, which controls the maximum number of items returned.</span></span> <span data-ttu-id="7ee3f-220">Toutefois, le nombre d’éléments sur le serveur qui correspondent à votre recherche peut être supérieur à la taille de l’affichage.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-220">However, the number of items on the server that match your search might be larger than the view size.</span></span> <span data-ttu-id="7ee3f-221">Dans ce cas, le serveur indique que d’autres éléments sont disponibles.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-221">In this case, the server indicates that more items are available.</span></span> <span data-ttu-id="7ee3f-222">Vous pouvez [utiliser la pagination pour répéter votre recherche](how-to-perform-paged-searches-by-using-ews-in-exchange.md) et obtenir l’ensemble de résultats suivant.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-222">You can [use paging to repeat your search](how-to-perform-paged-searches-by-using-ews-in-exchange.md) and get the next set of results.</span></span>

<span data-ttu-id="7ee3f-223">Par exemple, vous pouvez envoyer une demande de recherche avec une taille d’affichage de 10.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-223">For example, you can send a search request with a view size of 10.</span></span> <span data-ttu-id="7ee3f-224">Il peut y avoir 15 éléments sur le serveur qui correspondent à votre recherche, mais vous obtiendrez uniquement les 10 premiers, ainsi qu’un indicateur ( [FindItemsResults \<TItem\> . Propriété MoreAvailable](https://msdn.microsoft.com/library/dd635477%28v=exchg.80%29.aspx) si vous utilisez l’API managée EWS), il existe d’autres résultats sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-224">There might be 15 items on the server that match your search, but you will only get back the first 10, along with an indicator (the [FindItemsResults\<TItem\>.MoreAvailable](https://msdn.microsoft.com/library/dd635477%28v=exchg.80%29.aspx) property if you're using the EWS Managed API) that there are more results on the server.</span></span> <span data-ttu-id="7ee3f-225">Vous pouvez ensuite envoyer la même recherche avec un décalage de 10 pour demander les 10 éléments suivants qui correspondent à votre recherche.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-225">You can then send the same search with an offset of 10 to ask for the next 10 items that match your search.</span></span> <span data-ttu-id="7ee3f-226">Le serveur renverra les cinq éléments restants.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-226">The server will return the remaining five items.</span></span>

<span data-ttu-id="7ee3f-227">**Figure 1. Exemple de recherche paginée**</span><span class="sxs-lookup"><span data-stu-id="7ee3f-227">**Figure 1. Paged search example**</span></span>

![Illustration présentant une recherche paginée.](media/Ex15_Search_PagedSearch.png)

### <a name="grouping"></a><span data-ttu-id="7ee3f-231">Regroupement</span><span class="sxs-lookup"><span data-stu-id="7ee3f-231">Grouping</span></span>

 <span data-ttu-id="7ee3f-232">Exchange vous permet de regrouper les résultats de la recherche selon un champ spécifique.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-232">Exchange enables you to group search results by a specific field.</span></span> <span data-ttu-id="7ee3f-233">Cela peut vous aider à diviser les résultats de la recherche en ensembles plus faciles à gérer.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-233">This can help break up search results into more manageable sets.</span></span> <span data-ttu-id="7ee3f-234">Par exemple, vous pouvez rechercher « notes de réunion » et regrouper les résultats par expéditeur.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-234">For example, you can search for "meeting notes" and group the results by sender.</span></span> <span data-ttu-id="7ee3f-235">Comme illustré dans la figure suivante, les éléments renvoyés seront séparés en groupes, avec tous les éléments correspondant aux critères du même expéditeur dans un groupe, tous les éléments correspondants d’un autre expéditeur dans un autre groupe, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-235">As shown in the following figure, the items returned will be separated into groups, with all the items that match the criteria from the same sender in one group, all the matching items from another sender in another group, and so on.</span></span>

<span data-ttu-id="7ee3f-236">**Figure 2. Résultats de la recherche groupés par expéditeur**</span><span class="sxs-lookup"><span data-stu-id="7ee3f-236">**Figure 2. Search results grouped by sender**</span></span>

![Illustration présentant les résultats de recherche regroupés par expéditeur.](media/Ex15_Search_GroupedResults.png)

## <a name="search-folders"></a><span data-ttu-id="7ee3f-238">Dossiers de recherche</span><span class="sxs-lookup"><span data-stu-id="7ee3f-238">Search folders</span></span>
<span data-ttu-id="7ee3f-239"><a name="bk_SearchFolders"> </a></span><span class="sxs-lookup"><span data-stu-id="7ee3f-239"><a name="bk_SearchFolders"> </a></span></span>

<span data-ttu-id="7ee3f-240">Avec une recherche régulière, la recherche est exécutée, les résultats sont renvoyés à votre application pour traitement et la recherche cesse d’exister.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-240">With a regular search, the search is executed, the results are returned to your application for processing, and the search ceases to exist.</span></span> <span data-ttu-id="7ee3f-241">Les dossiers de recherche permettent de rendre un processus de recherche permanent.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-241">Search folders provide a way to make a search persistent.</span></span> <span data-ttu-id="7ee3f-242">Il s’agit d’une option intéressante pour les recherches que vous souhaitez exécuter plusieurs fois.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-242">This is a great option for searches that you know you will want to execute multiple times.</span></span> <span data-ttu-id="7ee3f-243">Au lieu d’exécuter la même recherche à plusieurs reprises, ce qui entraîne l’évaluation de la recherche à partir de zéro à chaque fois, un dossier de recherche effectue une recherche toujours, ce qui permet au serveur de mettre à jour le jeu de résultats existant lorsque des éléments sont ajoutés ou supprimés de l’étendue de recherche.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-243">Rather than executing the same search repeatedly, causing the server to evaluate the search from scratch each time, a search folder makes a search always on, allowing the server to update the existing result set as items are added to or removed from the search scope.</span></span> <span data-ttu-id="7ee3f-244">Les dossiers de recherche agissent comme des dossiers ordinaires, dans la mesure où ils apparaissent sous la forme de dossiers contenant des éléments.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-244">Search folders act like regular folders, in that they appear as folders that have items in them.</span></span> <span data-ttu-id="7ee3f-245">La différence réside dans le fait que les seuls éléments contenus dans le dossier sont ceux qui correspondent aux critères de recherche associés au dossier.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-245">The difference is that the only items contained in the folder are those that match the search criteria that are associated with the folder.</span></span> <span data-ttu-id="7ee3f-246">Une fois qu’un dossier de recherche est créé, votre application peut obtenir les résultats de la recherche à jour, en vérifiant simplement le contenu du dossier.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-246">After a search folder is created, your application can get up-to-date results of the search just by checking the contents of the folder.</span></span>

<span data-ttu-id="7ee3f-247">La création d’un dossier de recherche est simple lorsque vous maîtrisez la création de filtres de recherche.</span><span class="sxs-lookup"><span data-stu-id="7ee3f-247">Creating a search folder is simple when you've mastered creating search filters.</span></span> <span data-ttu-id="7ee3f-248">Dans l’exemple suivant, un dossier de recherche est créé pour afficher tous les messages électroniques dont l’objet contient « notes de réunion ».</span><span class="sxs-lookup"><span data-stu-id="7ee3f-248">In the following example, a search folder is created to show all email with a subject that contains "meeting notes".</span></span>

```cs
static void CreateSearchFolder(ExchangeService service)
{
    SearchFilter.ContainsSubstring subjectFilter = new SearchFilter.ContainsSubstring(ItemSchema.Subject,
        "meeting notes", ContainmentMode.Substring, ComparisonMode.IgnoreCase);
    SearchFolder searchFolder = new SearchFolder(service);
    searchFolder.DisplayName = "Meeting Notes";
    searchFolder.SearchParameters.RootFolderIds.Add(WellKnownFolderName.Inbox);
    searchFolder.SearchParameters.Traversal = SearchFolderTraversal.Deep;
    searchFolder.SearchParameters.SearchFilter = subjectFilter;
    searchFolder.Save(WellKnownFolderName.SearchFolders);
}
```

## <a name="in-this-section"></a><span data-ttu-id="7ee3f-249">Dans cette section</span><span class="sxs-lookup"><span data-stu-id="7ee3f-249">In this section</span></span>
<span data-ttu-id="7ee3f-250"><a name="bk_InThisSection"> </a></span><span class="sxs-lookup"><span data-stu-id="7ee3f-250"><a name="bk_InThisSection"> </a></span></span>

- [<span data-ttu-id="7ee3f-251">Utiliser des filtres de recherche avec EWS dans Exchange</span><span class="sxs-lookup"><span data-stu-id="7ee3f-251">Use search filters with EWS in Exchange</span></span>](how-to-use-search-filters-with-ews-in-exchange.md)

- [<span data-ttu-id="7ee3f-252">Effectuer une recherche AQS à l’aide d’EWS dans Exchange</span><span class="sxs-lookup"><span data-stu-id="7ee3f-252">Perform an AQS search by using EWS in Exchange</span></span>](how-to-perform-an-aqs-search-by-using-ews-in-exchange.md)

- [<span data-ttu-id="7ee3f-253">Effectuer des recherches paginées à l’aide d’EWS dans Exchange</span><span class="sxs-lookup"><span data-stu-id="7ee3f-253">Perform paged searches by using EWS in Exchange</span></span>](how-to-perform-paged-searches-by-using-ews-in-exchange.md)

- [<span data-ttu-id="7ee3f-254">Effectuer des recherches groupées à l’aide d’EWS dans Exchange</span><span class="sxs-lookup"><span data-stu-id="7ee3f-254">Perform grouped searches by using EWS in Exchange</span></span>](how-to-perform-grouped-searches-by-using-ews-in-exchange.md)

- [<span data-ttu-id="7ee3f-255">Utiliser des dossiers de recherche à l’aide d’EWS dans Exchange</span><span class="sxs-lookup"><span data-stu-id="7ee3f-255">Work with search folders by using EWS in Exchange</span></span>](how-to-work-with-search-folders-by-using-ews-in-exchange.md)

## <a name="see-also"></a><span data-ttu-id="7ee3f-256">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="7ee3f-256">See also</span></span>


- [<span data-ttu-id="7ee3f-257">Développer des clients de service web pour Exchange</span><span class="sxs-lookup"><span data-stu-id="7ee3f-257">Develop web service clients for Exchange</span></span>](develop-web-service-clients-for-exchange.md)

- [<span data-ttu-id="7ee3f-258">Dossier éléments récupérables</span><span class="sxs-lookup"><span data-stu-id="7ee3f-258">Recoverable Items Folder</span></span>](https://docs.microsoft.com/exchange/policy-and-compliance/recoverable-items-folder/recoverable-items-folder)

- [<span data-ttu-id="7ee3f-259">ExchangeService. FindItems</span><span class="sxs-lookup"><span data-stu-id="7ee3f-259">ExchangeService.FindItems</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.exchangeservice.finditems%28v=exchg.80%29.aspx)

- [<span data-ttu-id="7ee3f-260">Paramètres de stratégie de limitation qui affectent les opérations de recherche EWS</span><span class="sxs-lookup"><span data-stu-id="7ee3f-260">Throttling policy parameters that affect EWS search operations</span></span>](ews-throttling-in-exchange.md#throttling-policy-parameters-that-affect-ews-search-operations)
