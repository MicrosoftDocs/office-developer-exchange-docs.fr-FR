---
title: L’instrumentation les demandes des clients pour EWS et reste dans Exchange
manager: sethgros
ms.date: 4/13/2016
ms.audience: Developer
localization_priority: Normal
ms.assetid: 330de503-498d-447e-b4a9-c20fc1699fd1
description: En savoir plus sur les en-têtes HTTP dans les services EWS et des requêtes REST et les réponses qui peuvent vous aider à surveiller et dépanner votre application Exchange.
ms.openlocfilehash: bcf362952c29956729c44397043a56bf3603d0af
ms.sourcegitcommit: 34041125dc8c5f993b21cebfc4f8b72f0fd2cb6f
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19754968"
---
# <a name="instrumenting-client-requests-for-ews-and-rest-in-exchange"></a><span data-ttu-id="e453f-103">L’instrumentation les demandes des clients pour EWS et reste dans Exchange</span><span class="sxs-lookup"><span data-stu-id="e453f-103">Instrumenting client requests for EWS and REST in Exchange</span></span>

<span data-ttu-id="e453f-104">En savoir plus sur les en-têtes HTTP dans les services EWS et des requêtes REST et les réponses qui peuvent vous aider à surveiller et dépanner votre application Exchange.</span><span class="sxs-lookup"><span data-stu-id="e453f-104">Learn about the HTTP headers in EWS and REST requests and responses that can help you monitor and troubleshoot your Exchange application.</span></span>
  
<span data-ttu-id="e453f-105">Cela jamais arrivé à vous ?</span><span class="sxs-lookup"><span data-stu-id="e453f-105">Has this ever happened to you?</span></span> <span data-ttu-id="e453f-106">Un utilisateur de votre application indique une erreur inattendue.</span><span class="sxs-lookup"><span data-stu-id="e453f-106">A user of your application reports an unexpected error.</span></span> <span data-ttu-id="e453f-107">Vous souhaitez examiner, mais vous ne pouvez pas le reproduire.</span><span class="sxs-lookup"><span data-stu-id="e453f-107">You want to investigate, but you can't reproduce it.</span></span> <span data-ttu-id="e453f-108">L’erreur a disparu de l’utilisateur, et il reste très peu de données pertinentes.</span><span class="sxs-lookup"><span data-stu-id="e453f-108">The error has disappeared for the user, and you're left with very little actionable data.</span></span> <span data-ttu-id="e453f-109">Frustrant, non ?</span><span class="sxs-lookup"><span data-stu-id="e453f-109">Frustrating, isn't it?</span></span> <span data-ttu-id="e453f-110">Voyons comment vous pouvez anticiper ce scénario et espère éviter frustration à l’avenir.</span><span class="sxs-lookup"><span data-stu-id="e453f-110">Let's look at how you can proactively prepare for this scenario and hopefully avoid frustration in the future.</span></span>
  
## <a name="add-instrumentation-to-requests"></a><span data-ttu-id="e453f-111">Ajouter l’instrumentation aux demandes</span><span class="sxs-lookup"><span data-stu-id="e453f-111">Add instrumentation to requests</span></span>

<span data-ttu-id="e453f-112">Nous vous recommandons d’ajouter des en-têtes HTTP supplémentaires à vos demandes afin de faciliter la résolution des problèmes.</span><span class="sxs-lookup"><span data-stu-id="e453f-112">We recommend that you add additional HTTP headers to your requests to facilitate troubleshooting.</span></span> <span data-ttu-id="e453f-113">Vous devez garder une trace de ces informations en cours (par exemple, dans un fichier journal) afin que vous pouvez le récupérer ultérieurement si vous avez besoin.</span><span class="sxs-lookup"><span data-stu-id="e453f-113">You should keep a record of this information somewhere (for example, in a log file) so that you can retrieve it later if you need to.</span></span> <span data-ttu-id="e453f-114">Cela est utile lors de l’examen du trafic réseau et est également utile si vous contactez le support technique Microsoft pour obtenir une assistance.</span><span class="sxs-lookup"><span data-stu-id="e453f-114">This is helpful when examining network traffic, and is also helpful if you contact Microsoft support for assistance.</span></span>
  
<span data-ttu-id="e453f-115">**Le tableau 1. En-têtes de requête pour la résolution des problèmes**</span><span class="sxs-lookup"><span data-stu-id="e453f-115">**Table 1. Request headers for troubleshooting**</span></span>

|<span data-ttu-id="e453f-116">**En-tête HTTP (EWS)**</span><span class="sxs-lookup"><span data-stu-id="e453f-116">**HTTP header (EWS)**</span></span>|<span data-ttu-id="e453f-117">**Équivalent de l’API managée EWS**</span><span class="sxs-lookup"><span data-stu-id="e453f-117">**EWS Managed API equivalent**</span></span>|<span data-ttu-id="e453f-118">**Remarques**</span><span class="sxs-lookup"><span data-stu-id="e453f-118">**Notes**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="e453f-119">Agent utilisateur</span><span class="sxs-lookup"><span data-stu-id="e453f-119">User-Agent</span></span>  <br/> |[<span data-ttu-id="e453f-120">ExchangeService.UserAgent</span><span class="sxs-lookup"><span data-stu-id="e453f-120">ExchangeService.UserAgent</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservicebase.useragent%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="e453f-121">Définir une valeur unique qui identifie l’application cliente.</span><span class="sxs-lookup"><span data-stu-id="e453f-121">Set this to a unique value that identifies your client application.</span></span><br/><br/> <span data-ttu-id="e453f-122">À l’aide de la même valeur pour toutes les demandes de votre application envoie permet à Microsoft de résoudre les échecs des appels, ils surviendrait.</span><span class="sxs-lookup"><span data-stu-id="e453f-122">Using the same value for all requests that your application sends allows Microsoft to help troubleshoot call failures, should they arise.</span></span>  <br/> |
|<span data-ttu-id="e453f-123">id de demande client</span><span class="sxs-lookup"><span data-stu-id="e453f-123">client-request-id</span></span>  <br/> |[<span data-ttu-id="e453f-124">ExchangeService.ClientRequestId</span><span class="sxs-lookup"><span data-stu-id="e453f-124">ExchangeService.ClientRequestId</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservicebase.clientrequestid%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="e453f-125">Définir une autre valeur unique pour chaque demande de que votre application envoie.</span><span class="sxs-lookup"><span data-stu-id="e453f-125">Set this to a different unique value for every request your application sends.</span></span><br/><br/> <span data-ttu-id="e453f-126">Nous recommandons d’utiliser un GUID.</span><span class="sxs-lookup"><span data-stu-id="e453f-126">We recommend that you use a GUID.</span></span> <span data-ttu-id="e453f-127">Cet identificateur unique est destiné à être utilisé pour mettre en corrélation les activités entre deux systèmes dans le cas où quelque chose ne fonctionnerait pas.</span><span class="sxs-lookup"><span data-stu-id="e453f-127">This unique identifier is intended to be used to correlate activities between two systems in the event that something goes wrong.</span></span>  <br/> |
|<span data-ttu-id="e453f-128">retour-client--id de demande</span><span class="sxs-lookup"><span data-stu-id="e453f-128">return-client-request-id</span></span>  <br/> |[<span data-ttu-id="e453f-129">ExchangeService.ReturnClientRequestId</span><span class="sxs-lookup"><span data-stu-id="e453f-129">ExchangeService.ReturnClientRequestId</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservicebase.returnclientrequestid%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="e453f-130">Définir sur **true** pour signaler sur le serveur Exchange qu’elle doit retourner la valeur de votre id de demande de client dans la réponse correspondante.</span><span class="sxs-lookup"><span data-stu-id="e453f-130">Set this to **true** to signal to the Exchange server that it should return the value of your client-request-id in the corresponding response.</span></span><br/><br/> <span data-ttu-id="e453f-131">Vous pouvez utiliser ce pour faire correspondre les demandes et réponses dans les suivis réseau ou des traces de l’API managée EWS.</span><span class="sxs-lookup"><span data-stu-id="e453f-131">You can use this to correlate requests and responses in network traces or EWS Managed API traces.</span></span>  <br/> |
|<span data-ttu-id="e453f-132">X-ClientStatistics</span><span class="sxs-lookup"><span data-stu-id="e453f-132">X-ClientStatistics</span></span>  <br/> |[<span data-ttu-id="e453f-133">ExchangeService.SendClientLatencies</span><span class="sxs-lookup"><span data-stu-id="e453f-133">ExchangeService.SendClientLatencies</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservicebase.sendclientlatencies%28v=exchg.80%29.aspx) <br/> |<span data-ttu-id="e453f-134">Utilisé pour [les latences EWS rapport](#bk_ReportLatency) à Microsoft si votre application accède à Exchange Online ou Exchange Online dans le cadre d’Office 365.</span><span class="sxs-lookup"><span data-stu-id="e453f-134">Used to [report EWS latencies](#bk_ReportLatency) to Microsoft if your application is accessing Exchange Online or Exchange Online as part of Office 365.</span></span>  <br/> |
   
## <a name="log-information-from-responses"></a><span data-ttu-id="e453f-135">Informations du journal des réponses</span><span class="sxs-lookup"><span data-stu-id="e453f-135">Log information from responses</span></span>

<span data-ttu-id="e453f-136">Comme votre client peut ajouter instrumentation supplémentaires pour les demandes, qu'il envoie, Exchange ajoute instrumentation supplémentaires pour les réponses sous la forme d’en-têtes HTTP.</span><span class="sxs-lookup"><span data-stu-id="e453f-136">Just as your client can add additional instrumentation to the requests it sends, Exchange adds additional instrumentation to the responses in the form of HTTP headers.</span></span> <span data-ttu-id="e453f-137">Votre client doit capturer ces informations pour accéder ainsi que les informations d’instrumentation de demande.</span><span class="sxs-lookup"><span data-stu-id="e453f-137">Your client should capture this information to go along with the request instrumentation information.</span></span>
  
> [!NOTE]
> <span data-ttu-id="e453f-138">Si vous utilisez l’API managée EWS, il n’existe aucun équivalent direct pour les en-têtes HTTP.</span><span class="sxs-lookup"><span data-stu-id="e453f-138">If you are using the EWS Managed API, there is no direct equivalent for the HTTP headers.</span></span> <span data-ttu-id="e453f-139">Toutefois, tous les en-têtes de réponse HTTP est accessible via la propriété [ExchangeService.HttpResponseHeaders](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservicebase.httpresponseheaders%28v=exchg.80%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="e453f-139">However, all HTTP response headers can be accessed via the [ExchangeService.HttpResponseHeaders](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservicebase.httpresponseheaders%28v=exchg.80%29.aspx) property.</span></span> 
  
<span data-ttu-id="e453f-140">**Le tableau 2. En-têtes de réponse HTTP**</span><span class="sxs-lookup"><span data-stu-id="e453f-140">**Table 2. HTTP response headers**</span></span>

|<span data-ttu-id="e453f-141">**En-tête HTTP**</span><span class="sxs-lookup"><span data-stu-id="e453f-141">**HTTP header**</span></span>|<span data-ttu-id="e453f-142">**Description**</span><span class="sxs-lookup"><span data-stu-id="e453f-142">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="e453f-143">id de la demande</span><span class="sxs-lookup"><span data-stu-id="e453f-143">request-id</span></span>  <br/> |<span data-ttu-id="e453f-144">Un ID généré par le serveur pour la demande qui correspond à cette réponse.</span><span class="sxs-lookup"><span data-stu-id="e453f-144">A server-generated ID for the request that corresponds to this response.</span></span>  <br/> |
|<span data-ttu-id="e453f-145">id de demande client</span><span class="sxs-lookup"><span data-stu-id="e453f-145">client-request-id</span></span>  <br/> |<span data-ttu-id="e453f-146">La valeur de l’en-tête de l’id de demande de client dans la demande.</span><span class="sxs-lookup"><span data-stu-id="e453f-146">The value of the client-request-id header in the request.</span></span><br/><br/> <span data-ttu-id="e453f-147">Cet en-tête est présent uniquement si la requête contient l’en-tête de retour-client-demande-id avec la valeur **true**.</span><span class="sxs-lookup"><span data-stu-id="e453f-147">This header is only present if the request contains the return-client-request-id header with a value of **true**.</span></span>  <br/> |
|<span data-ttu-id="e453f-148">X-FEServer</span><span class="sxs-lookup"><span data-stu-id="e453f-148">X-FEServer</span></span>  <br/> |<span data-ttu-id="e453f-149">Le nom de domaine complet du serveur d’accès Client qui ont traité la demande.</span><span class="sxs-lookup"><span data-stu-id="e453f-149">The FQDN of the Client Access server that processed the request.</span></span>  <br/> |
|<span data-ttu-id="e453f-150">X-TargetBEServer</span><span class="sxs-lookup"><span data-stu-id="e453f-150">X-TargetBEServer</span></span>  <br/> |<span data-ttu-id="e453f-151">Le nom de domaine complet du serveur de boîtes aux lettres qui ont traité la demande.</span><span class="sxs-lookup"><span data-stu-id="e453f-151">The FQDN of the mailbox server that processed the request.</span></span>  <br/> |
|<span data-ttu-id="e453f-152">X-DiagInfo</span><span class="sxs-lookup"><span data-stu-id="e453f-152">X-DiagInfo</span></span>  <br/> |<span data-ttu-id="e453f-153">Informations de diagnostic supplémentaires, en fonction de la demande.</span><span class="sxs-lookup"><span data-stu-id="e453f-153">Additional diagnostic information, depending on the request.</span></span>  <br/> |
|<span data-ttu-id="e453f-154">x-ms-diagnostics</span><span class="sxs-lookup"><span data-stu-id="e453f-154">x-ms-diagnostics</span></span>  <br/> | <span data-ttu-id="e453f-155">Cet en-tête s’applique uniquement si l’authentification OAuth est utilisée dans la demande.</span><span class="sxs-lookup"><span data-stu-id="e453f-155">This header is only applicable if OAuth authentication is used in the request.</span></span><br/><br/> <span data-ttu-id="e453f-156">Il contient un code d’erreur explicites qui spécifie la raison de l’échec d’authentification OAuth.</span><span class="sxs-lookup"><span data-stu-id="e453f-156">It contains an explicit error code that specifies why an OAuth authentication failed.</span></span><br/><br/> <span data-ttu-id="e453f-157">Elle prend le format suivant :`errorId;reason="reason"error_type="error type"`</span><span class="sxs-lookup"><span data-stu-id="e453f-157">It takes the following format: `errorId;reason="reason"error_type="error type"`</span></span><br/><br/> <span data-ttu-id="e453f-158">Le champ **raison** est une description explicite de l’erreur.</span><span class="sxs-lookup"><span data-stu-id="e453f-158">The **reason** field is a human-readable description of the error.</span></span><br/><br/> <span data-ttu-id="e453f-159">Le champ **code d’erreur** est un entier et le **erreur\_type** champ est la représentation sous forme de chaîne de cet entier, comme suit :</span><span class="sxs-lookup"><span data-stu-id="e453f-159">The **errorId** field is an integer, and the **error\_type** field is the string representation of that integer, as follows:</span></span><ul><li><span data-ttu-id="e453f-160">2000000 : non valide\_signature</span><span class="sxs-lookup"><span data-stu-id="e453f-160">2000000: invalid\_signature</span></span></li><li><span data-ttu-id="e453f-161">2000001 : non valide\_jeton</span><span class="sxs-lookup"><span data-stu-id="e453f-161">2000001: invalid\_token</span></span></li><li>  <span data-ttu-id="e453f-162">2000002 : jeton\_a expiré</span><span class="sxs-lookup"><span data-stu-id="e453f-162">2000002: token\_expired</span></span></li><li><span data-ttu-id="e453f-163">2000003 : non valide\_ressource</span><span class="sxs-lookup"><span data-stu-id="e453f-163">2000003: invalid\_resource</span></span></li><li><span data-ttu-id="e453f-164">2000004 : non valide\_client</span><span class="sxs-lookup"><span data-stu-id="e453f-164">2000004: invalid\_tenant</span></span>  </li><li><span data-ttu-id="e453f-165">2000005 : non valide\_utilisateur</span><span class="sxs-lookup"><span data-stu-id="e453f-165">2000005: invalid\_user</span></span></li><li><span data-ttu-id="e453f-166">2000006 : non valide\_client</span><span class="sxs-lookup"><span data-stu-id="e453f-166">2000006: invalid\_client</span></span></li><li><span data-ttu-id="e453f-167">2000007 : interne\_erreur</span><span class="sxs-lookup"><span data-stu-id="e453f-167">2000007: internal\_error</span></span></li><li><span data-ttu-id="e453f-168">2000008 : non valide\_accorder</span><span class="sxs-lookup"><span data-stu-id="e453f-168">2000008: invalid\_grant</span></span></li></ul> |
   
## <a name="report-ews-latency-to-microsoft"></a><span data-ttu-id="e453f-169">Latence EWS rapport à Microsoft</span><span class="sxs-lookup"><span data-stu-id="e453f-169">Report EWS latency to Microsoft</span></span>
<span data-ttu-id="e453f-170"><a name="bk_ReportLatency"> </a></span><span class="sxs-lookup"><span data-stu-id="e453f-170"></span></span>

<span data-ttu-id="e453f-171">Si votre application utilise les API managées EWS pour se connecter à Exchange Online, vous pouvez signaler la latence des demandes EWS directement à Microsoft.</span><span class="sxs-lookup"><span data-stu-id="e453f-171">If your application uses the EWS Managed API or EWS to connect to Exchange Online, you can report latency in EWS requests directly to Microsoft.</span></span> <span data-ttu-id="e453f-172">Les informations sont transmises par le biais de l’en-tête de demande X-ClientStatistics.</span><span class="sxs-lookup"><span data-stu-id="e453f-172">The information is passed via the X-ClientStatistics request header.</span></span> <span data-ttu-id="e453f-173">Si vous utilisez l’API managée EWS, il vous est définie à la propriété [ExchangeService.SendClientLatencies](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservicebase.sendclientlatencies%28v=exchg.80%29.aspx) sur **true**.</span><span class="sxs-lookup"><span data-stu-id="e453f-173">If you are using the EWS Managed API, all you have to do is set the [ExchangeService.SendClientLatencies](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.exchangeservicebase.sendclientlatencies%28v=exchg.80%29.aspx) property to **true**.</span></span> <span data-ttu-id="e453f-174">Si vous utilisez EWS, vous devez mesurer le délai entre l’émission d’une demande et recevoir une réponse, puis ajoutez l’en-tête X-ClientStatistics à la prochaine demande EWS votre application envoie, en utilisant le format suivant.</span><span class="sxs-lookup"><span data-stu-id="e453f-174">If you are using EWS, you'll need to measure the time between issuing a request and receiving a response, then add the X-ClientStatistics header to the next EWS request your application sends, using the following format.</span></span>
  
`X-ClientStatistics: MessageId=<value of request-id header>,ResponseTime=<time in milliseconds>,SoapAction=<EWS operation>`
  
<span data-ttu-id="e453f-175">Nous tenir à jour des rapports pour ces latences et les utiliser pour améliorer en continu les services EWS dans Exchange Online.</span><span class="sxs-lookup"><span data-stu-id="e453f-175">We maintain reports for these latencies and use them to continuously improve EWS services in Exchange Online.</span></span>
  
## <a name="next-steps"></a><span data-ttu-id="e453f-176">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="e453f-176">Next steps</span></span>
<span data-ttu-id="e453f-177"><a name="bk_ReportLatency"> </a></span><span class="sxs-lookup"><span data-stu-id="e453f-177"></span></span>

<span data-ttu-id="e453f-178">Après avoir ajouté instrumentation client à votre application, vous êtes mieux si quelque chose ne fonctionnerait pas.</span><span class="sxs-lookup"><span data-stu-id="e453f-178">After you've added client instrumentation to your application, you're better prepared if something goes wrong.</span></span> <span data-ttu-id="e453f-179">Dans ce cas, vous pouvez utiliser vos données WMI pour [résoudre les problèmes de votre application](tools-and-resources-for-troubleshooting-ews-applications-for-exchange.md).</span><span class="sxs-lookup"><span data-stu-id="e453f-179">If that happens, you can use your instrumentation data to [troubleshoot your application](tools-and-resources-for-troubleshooting-ews-applications-for-exchange.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="e453f-180">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="e453f-180">See also</span></span>

- [<span data-ttu-id="e453f-181">Vue d'ensemble de la conception client EWS pour Exchange</span><span class="sxs-lookup"><span data-stu-id="e453f-181">EWS client design overview for Exchange</span></span>](ews-client-design-overview-for-exchange.md)
- [<span data-ttu-id="e453f-182">Suivi des demandes et réponses pour dépanner les applications de l’API managée EWS</span><span class="sxs-lookup"><span data-stu-id="e453f-182">Trace requests and responses to troubleshoot EWS Managed API applications</span></span>](how-to-trace-requests-responses-to-troubleshoot-ews-managed-api-applications.md)
- [<span data-ttu-id="e453f-183">Outils et ressources pour la résolution des applications EWS pour Exchange</span><span class="sxs-lookup"><span data-stu-id="e453f-183">Tools and resources for troubleshooting EWS applications for Exchange</span></span>](tools-and-resources-for-troubleshooting-ews-applications-for-exchange.md)
    

