---
title: Les pièces jointes et les services EWS d’Exchange
manager: sethgros
ms.date: 7/11/2016
ms.audience: Developer
localization_priority: Normal
ms.assetid: 8e4289a4-ec9d-4502-9854-c593c95d5f98
description: Découvrez comment des API managées EWS dans Exchange client représente les et les pièces jointes.
ms.openlocfilehash: e4a97873798b8252e6fc14003519ce8a0eab7ec8
ms.sourcegitcommit: 34041125dc8c5f993b21cebfc4f8b72f0fd2cb6f
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/25/2018
ms.locfileid: "19754763"
---
# <a name="attachments-and-ews-in-exchange"></a><span data-ttu-id="cc5ea-103">Les pièces jointes et les services EWS d’Exchange</span><span class="sxs-lookup"><span data-stu-id="cc5ea-103">Attachments and EWS in Exchange</span></span>

<span data-ttu-id="cc5ea-104">Découvrez comment des API managées EWS dans Exchange client représente les et les pièces jointes.</span><span class="sxs-lookup"><span data-stu-id="cc5ea-104">Learn about attachments and how your EWS Managed API or EWS in Exchange client represents them.</span></span>
  
<span data-ttu-id="cc5ea-105">En règle générale, les pièces jointes sont associés à des éléments de messagerie électronique, mais en fait, tous les éléments EWS : email messages, éléments de calendrier, contacts, tâches, peuvent inclure des pièces jointes.</span><span class="sxs-lookup"><span data-stu-id="cc5ea-105">Usually, attachments are associated with email items, but in fact, all EWS items — email messages, calendar items, contacts, tasks — can include attachments.</span></span>
  
## <a name="types-of-attachments"></a><span data-ttu-id="cc5ea-106">Types de pièces jointes</span><span class="sxs-lookup"><span data-stu-id="cc5ea-106">Types of attachments</span></span>

<span data-ttu-id="cc5ea-107">EWS catégorise les pièces jointes en deux groupes : les pièces jointes et des pièces jointes d’éléments du fichier.</span><span class="sxs-lookup"><span data-stu-id="cc5ea-107">EWS categorizes attachments into two groups: file attachments and item attachments.</span></span>
  
- <span data-ttu-id="cc5ea-108">**Pièces jointes d’élément :** Fortement typé [éléments EWS](folders-and-items-in-ews-in-exchange.md), tels que des messages électroniques et des éléments de calendrier, attachés à un autre élément EWS fortement typé.</span><span class="sxs-lookup"><span data-stu-id="cc5ea-108">**Item attachments:** Strongly-typed [EWS items](folders-and-items-in-ews-in-exchange.md), such as email messages and calendar items, that are attached to another strongly-typed EWS item.</span></span> <span data-ttu-id="cc5ea-109">N’importe quel élément fortement typé qui peut être créé à l’aide de l’API managée EWS ou EWS peut être utilisé en tant que pièce jointe d’un élément.</span><span class="sxs-lookup"><span data-stu-id="cc5ea-109">Any strongly-typed item that can be created by using the EWS Managed API or EWS can be used as an item attachment.</span></span> <span data-ttu-id="cc5ea-110">Le contenu de pièce jointe d’un élément est l’élément fortement typé, qui fournit un accès facile à toutes ses propriétés.</span><span class="sxs-lookup"><span data-stu-id="cc5ea-110">The content of an item attachment is the strongly-typed item, which provides easy access to all its properties.</span></span> <span data-ttu-id="cc5ea-111">Pièces jointes d’élément peuvent avoir leurs propres pièces jointes d’élément, une hiérarchie de pièces jointes d’éléments (ou l’imbrication des pièces jointes) possible.</span><span class="sxs-lookup"><span data-stu-id="cc5ea-111">Item attachments can have their own item attachments, so a hierarchy of item attachments (or nesting of attachments) is possible.</span></span>
    
- <span data-ttu-id="cc5ea-112">**Les pièces jointes :** N’importe quel fichier, .txt, .jpg, .zip, .pdf, ou même un fichier .msg.</span><span class="sxs-lookup"><span data-stu-id="cc5ea-112">**File attachments:** Any file, such as a .txt, .jpg, .zip, .pdf, or even a .msg file.</span></span> <span data-ttu-id="cc5ea-113">Une pièce jointe a uniquement quelques propriétés, y compris le contenu codé en base 64 du fichier.</span><span class="sxs-lookup"><span data-stu-id="cc5ea-113">A file attachment only has a few properties, one of which is the base-64 encoded content of the file.</span></span> 
    
- <span data-ttu-id="cc5ea-114">**Référencer les pièces jointes :** Une pièce jointe est référencé par un fournisseur de fichier, tel qu’un fichier situé dans le nuage.</span><span class="sxs-lookup"><span data-stu-id="cc5ea-114">**Reference attachments:** Any attachment that is referenced by a file provider, such as a file located in the cloud.</span></span> <span data-ttu-id="cc5ea-115">Une pièce jointe peut être provenant de plusieurs fournisseurs.</span><span class="sxs-lookup"><span data-stu-id="cc5ea-115">An attachment can be from multiple providers.</span></span> 
    
<span data-ttu-id="cc5ea-116">Lorsque vous ajoutez ou récupérer les pièces jointes d’un élément, vous allez le faire différemment selon s’il s’agit d’une pièce jointe ou une pièce jointe d’élément.</span><span class="sxs-lookup"><span data-stu-id="cc5ea-116">When you add or retrieve attachments from an item, you'll do it differently depending on whether it's a file attachment or an item attachment.</span></span> <span data-ttu-id="cc5ea-117">Par exemple, pour ajouter une pièce jointe à un élément, vous pouvez seulement passer à l’emplacement du fichier.</span><span class="sxs-lookup"><span data-stu-id="cc5ea-117">For example, to add a file attachment to an item, you can just pass in the location of the file.</span></span> <span data-ttu-id="cc5ea-118">Pour ajouter un élément existant en tant que pièce jointe d’un élément, vous avez fait copier les propriétés ou le contenu MIME de l’élément existant vers une nouvelle pièce jointe d’élément ; Vous ne pouvez pas simplement lier à l’élément existant.</span><span class="sxs-lookup"><span data-stu-id="cc5ea-118">To add an existing item as an item attachment, you actually have to copy the properties or the MIME content of the existing item to a new item attachment; you can't just bind to the existing item.</span></span> <span data-ttu-id="cc5ea-119">Pour faire la distinction entre les deux types de pièces jointes est importante.</span><span class="sxs-lookup"><span data-stu-id="cc5ea-119">So distinguishing between the two types of attachments is important.</span></span> <span data-ttu-id="cc5ea-120">Plus d’informations sur les différences entre les pièces jointes d’éléments et les pièces jointes sont décrits dans les articles [de cette section](#bk_inthissection).</span><span class="sxs-lookup"><span data-stu-id="cc5ea-120">More details about the differences between item attachments and file attachments are discussed in the articles [In this section](#bk_inthissection).</span></span>
  
## <a name="how-are-attachments-represented-programmatically"></a><span data-ttu-id="cc5ea-121">Comment sont jointes représentés par programme ?</span><span class="sxs-lookup"><span data-stu-id="cc5ea-121">How are attachments represented programmatically?</span></span>

<span data-ttu-id="cc5ea-122">Pièces jointes sont stockés dans une collection de l’élément EWS.</span><span class="sxs-lookup"><span data-stu-id="cc5ea-122">Attachments are stored in a collection on the EWS item.</span></span> <span data-ttu-id="cc5ea-123">La collection attachments est composée de pièces jointes ou de pièces jointes d’élément.</span><span class="sxs-lookup"><span data-stu-id="cc5ea-123">The attachments collection is made up of file attachments and/or item attachments.</span></span> <span data-ttu-id="cc5ea-124">Métadonnées relatives à la collection de pièces jointes sont disponible lorsque vous obtenez un élément à l’aide de la méthode API managées [Item.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.bind%28v=exchg.80%29.aspx) ou l’opération EWS [GetItem](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) , mais les appels supplémentaires sont requis pour récupérer le contenu des pièces jointes.</span><span class="sxs-lookup"><span data-stu-id="cc5ea-124">Metadata about the attachment collection is available when you get an item by using the EWS Managed API [Item.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.bind%28v=exchg.80%29.aspx) method or the EWS [GetItem](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) operation, but additional calls are required to actually retrieve the contents of the attachments.</span></span> 
  
<span data-ttu-id="cc5ea-125">**Le tableau 1. Métadonnées d’élément relative aux pièces jointes**</span><span class="sxs-lookup"><span data-stu-id="cc5ea-125">**Table 1. Item metadata about attachments**</span></span>

|<span data-ttu-id="cc5ea-126">**Entité de métadonnées**</span><span class="sxs-lookup"><span data-stu-id="cc5ea-126">**Metadata entity**</span></span>|<span data-ttu-id="cc5ea-127">**Propriété API managées**</span><span class="sxs-lookup"><span data-stu-id="cc5ea-127">**EWS Managed API property**</span></span>|<span data-ttu-id="cc5ea-128">**Élément EWS**</span><span class="sxs-lookup"><span data-stu-id="cc5ea-128">**EWS element**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="cc5ea-129">Indicateur de pièce jointe (ne signale pas les pièces jointes en ligne)</span><span class="sxs-lookup"><span data-stu-id="cc5ea-129">Attachment indicator (does not flag inline attachments)</span></span>  <br/> |[<span data-ttu-id="cc5ea-130">Item.HasAttachments</span><span class="sxs-lookup"><span data-stu-id="cc5ea-130">Item.HasAttachments</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.hasattachments%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="cc5ea-131">HasAttachments</span><span class="sxs-lookup"><span data-stu-id="cc5ea-131">HasAttachments</span></span>](http://msdn.microsoft.com/library/538b7a85-11d7-4daa-8458-09b540760e8b%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="cc5ea-132">Collection de pièces jointes</span><span class="sxs-lookup"><span data-stu-id="cc5ea-132">Attachment collection</span></span>  <br/> |[<span data-ttu-id="cc5ea-133">Item.Attachments</span><span class="sxs-lookup"><span data-stu-id="cc5ea-133">Item.Attachments</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.attachments%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="cc5ea-134">Pièces jointes</span><span class="sxs-lookup"><span data-stu-id="cc5ea-134">Attachments</span></span>](http://msdn.microsoft.com/library/b470e614-34bb-44f0-8790-7ddbdcbbd29d%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="cc5ea-135">ID des pièces jointes</span><span class="sxs-lookup"><span data-stu-id="cc5ea-135">Attachment ID</span></span>  <br/> |[<span data-ttu-id="cc5ea-136">Attachment.Id</span><span class="sxs-lookup"><span data-stu-id="cc5ea-136">Attachment.Id</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.attachment.id%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="cc5ea-137">AttachmentId</span><span class="sxs-lookup"><span data-stu-id="cc5ea-137">AttachmentId</span></span>](http://msdn.microsoft.com/library/55a5fd77-60d1-40fa-8144-770600cedc6a%28Office.15%29.aspx) <br/> |
   
<span data-ttu-id="cc5ea-138">**Le tableau 2. Entités de pièce jointe**</span><span class="sxs-lookup"><span data-stu-id="cc5ea-138">**Table 2. Attachment entities**</span></span>

|<span data-ttu-id="cc5ea-139">**Type de pièce jointe**</span><span class="sxs-lookup"><span data-stu-id="cc5ea-139">**Attachment type**</span></span>|<span data-ttu-id="cc5ea-140">**Classe de l’API managée EWS**</span><span class="sxs-lookup"><span data-stu-id="cc5ea-140">**EWS Managed API class**</span></span>|<span data-ttu-id="cc5ea-141">**Élément EWS**</span><span class="sxs-lookup"><span data-stu-id="cc5ea-141">**EWS element**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="cc5ea-142">Pièce jointe</span><span class="sxs-lookup"><span data-stu-id="cc5ea-142">File attachment</span></span>  <br/> |[<span data-ttu-id="cc5ea-143">FileAttachment</span><span class="sxs-lookup"><span data-stu-id="cc5ea-143">FileAttachment</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.fileattachment%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="cc5ea-144">FileAttachment</span><span class="sxs-lookup"><span data-stu-id="cc5ea-144">FileAttachment</span></span>](http://msdn.microsoft.com/library/3ecea174-73d1-47fd-8917-6065cef1d565%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="cc5ea-145">Pièce jointe d’élément</span><span class="sxs-lookup"><span data-stu-id="cc5ea-145">Item attachment</span></span>  <br/> |[<span data-ttu-id="cc5ea-146">ItemAttachment</span><span class="sxs-lookup"><span data-stu-id="cc5ea-146">ItemAttachment</span></span>](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.itemattachment%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="cc5ea-147">ItemAttachment\<TItem\></span><span class="sxs-lookup"><span data-stu-id="cc5ea-147">ItemAttachment\<TItem\></span></span>](http://msdn.microsoft.com/en-us/library/dd635165%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="cc5ea-148">ItemAttachment</span><span class="sxs-lookup"><span data-stu-id="cc5ea-148">ItemAttachment</span></span>](http://msdn.microsoft.com/library/089ee599-f45e-46f5-a18a-5cfb3d2851ff%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="cc5ea-149">Pièce jointe de référence</span><span class="sxs-lookup"><span data-stu-id="cc5ea-149">Reference attachment</span></span>  <br/> |[<span data-ttu-id="cc5ea-150">Type complexe ReferenceAttachmentType (EWS)</span><span class="sxs-lookup"><span data-stu-id="cc5ea-150">ReferenceAttachmentType complexType (EWS)</span></span>](http://msdn.microsoft.com/library/18bfa012-e903-d7f3-528a-31ccceb65463%28Office.15%29.aspx) <br/> |[<span data-ttu-id="cc5ea-151">ReferenceAttachment</span><span class="sxs-lookup"><span data-stu-id="cc5ea-151">ReferenceAttachment</span></span>](http://msdn.microsoft.com/library/b9bde862-6b75-4a81-8033-00a47be4dc2f%28Office.15%29.aspx) <br/> |
   
## <a name="inline-attachments"></a><span data-ttu-id="cc5ea-152">Pièces jointes en ligne</span><span class="sxs-lookup"><span data-stu-id="cc5ea-152">Inline attachments</span></span>

<span data-ttu-id="cc5ea-153">Pièces jointes en ligne sont un type spécial de pièce jointe.</span><span class="sxs-lookup"><span data-stu-id="cc5ea-153">Inline attachments are a special breed of attachment.</span></span> <span data-ttu-id="cc5ea-154">Les deux pièces jointes et pièces jointes d’éléments peuvent être des pièces jointes en ligne.</span><span class="sxs-lookup"><span data-stu-id="cc5ea-154">Both file attachments and item attachments can be inline attachments.</span></span> <span data-ttu-id="cc5ea-155">Une pièce jointe incorporée s’affiche dans le cadre du contenu du corps et conserve sa position par rapport au reste du contenu dans l’élément.</span><span class="sxs-lookup"><span data-stu-id="cc5ea-155">An inline attachment appears as part of the body content and retains its position relative to the rest of the content in the item.</span></span> 
  
<span data-ttu-id="cc5ea-156">Une pièce jointe est une pièce jointe incorporée si la propriété API managées [IsInline](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.attachment.isinline%28v=exchg.80%29.aspx) ou l’élément EWS [IsInline](http://msdn.microsoft.com/library/5e7712c8-372a-4a16-be64-360c5ff3961a%28Office.15%29.aspx) est définie sur true.</span><span class="sxs-lookup"><span data-stu-id="cc5ea-156">An attachment is an inline attachment if the EWS Managed API [IsInline](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.attachment.isinline%28v=exchg.80%29.aspx) property or the EWS [IsInline](http://msdn.microsoft.com/library/5e7712c8-372a-4a16-be64-360c5ff3961a%28Office.15%29.aspx) element is set to true.</span></span> <span data-ttu-id="cc5ea-157">Pièces jointes en ligne utilisent les propriétés facultatives suivantes et les éléments pour identifier l’emplacement d’une pièce jointe incorporée :</span><span class="sxs-lookup"><span data-stu-id="cc5ea-157">Inline attachments use the following optional properties and elements to identify the location of an inline attachment:</span></span> 
  
- <span data-ttu-id="cc5ea-158">API managées — [ContentId](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.attachment.contentid%28v=exchg.80%29.aspx) ou [ContentLocation](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.attachment.contentlocation%28v=exchg.80%29.aspx) propriétés.</span><span class="sxs-lookup"><span data-stu-id="cc5ea-158">EWS Managed API — [ContentId](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.attachment.contentid%28v=exchg.80%29.aspx) or [ContentLocation](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.attachment.contentlocation%28v=exchg.80%29.aspx) properties.</span></span> 
    
- <span data-ttu-id="cc5ea-159">EWS — [ContentId](http://msdn.microsoft.com/library/bc59100d-6079-414b-a6e0-7c15feaa3184%28Office.15%29.aspx) ou [ContentLocation](http://msdn.microsoft.com/library/d91cf587-24e3-4c13-8784-5ca29787cca7%28Office.15%29.aspx) élément.</span><span class="sxs-lookup"><span data-stu-id="cc5ea-159">EWS — [ContentId](http://msdn.microsoft.com/library/bc59100d-6079-414b-a6e0-7c15feaa3184%28Office.15%29.aspx) or [ContentLocation](http://msdn.microsoft.com/library/d91cf587-24e3-4c13-8784-5ca29787cca7%28Office.15%29.aspx) element.</span></span> 
    
<span data-ttu-id="cc5ea-160">Notez que la propriété API managées [HasAttachments](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.hasattachments%28v=exchg.80%29.aspx) et l’élément EWS [HasAttachments](http://msdn.microsoft.com/library/538b7a85-11d7-4daa-8458-09b540760e8b%28Office.15%29.aspx) ne reflètent pas l’existence des pièces jointes en ligne et qui a pourquoi les pièces jointes en ligne sont également appelées masquée pièces jointes.</span><span class="sxs-lookup"><span data-stu-id="cc5ea-160">Note that the EWS Managed API [HasAttachments](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.hasattachments%28v=exchg.80%29.aspx) property and the EWS [HasAttachments](http://msdn.microsoft.com/library/538b7a85-11d7-4daa-8458-09b540760e8b%28Office.15%29.aspx) element do not reflect the existence of inline attachments, and that's why inline attachments are also called hidden attachments.</span></span> <span data-ttu-id="cc5ea-161">Si vous définissez la propriété API managées [IsInline](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.attachment.isinline%28v=exchg.80%29.aspx) ou l’élément EWS [IsInline](http://msdn.microsoft.com/library/5e7712c8-372a-4a16-be64-360c5ff3961a%28Office.15%29.aspx) sur true, et aucune autre pièces jointes, **HasAttachments** a la valeur false.</span><span class="sxs-lookup"><span data-stu-id="cc5ea-161">So if you set the EWS Managed API [IsInline](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.attachment.isinline%28v=exchg.80%29.aspx) property or the EWS [IsInline](http://msdn.microsoft.com/library/5e7712c8-372a-4a16-be64-360c5ff3961a%28Office.15%29.aspx) element to true, and the item has no other attachments, **HasAttachments** will be set to false.</span></span> <span data-ttu-id="cc5ea-162">Si votre client utilise **HasAttachments** pour remplir un indicateur de pièce jointe ou l’icône d’un message électronique, n’oubliez pas que l’icône n’apparaît pas pour les courriers électroniques avec les pièces jointes en ligne.</span><span class="sxs-lookup"><span data-stu-id="cc5ea-162">If your client uses **HasAttachments** to populate an attachment indicator or icon on an email, be aware that the icon will not appear for emails with inline attachments.</span></span> 
  
## <a name="in-this-section"></a><span data-ttu-id="cc5ea-163">Dans cette section</span><span class="sxs-lookup"><span data-stu-id="cc5ea-163">In this section</span></span>
<span data-ttu-id="cc5ea-164"><a name="bk_inthissection"> </a></span><span class="sxs-lookup"><span data-stu-id="cc5ea-164"></span></span>

- [<span data-ttu-id="cc5ea-165">Ajouter des pièces jointes à l’aide de EWS dans Exchange</span><span class="sxs-lookup"><span data-stu-id="cc5ea-165">Add attachments by using EWS in Exchange</span></span>](how-to-add-attachments-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="cc5ea-166">Obtenir des pièces jointes à l’aide de EWS dans Exchange</span><span class="sxs-lookup"><span data-stu-id="cc5ea-166">Get attachments by using EWS in Exchange</span></span>](how-to-get-attachments-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="cc5ea-167">Supprimez les pièces jointes à l’aide de EWS dans Exchange</span><span class="sxs-lookup"><span data-stu-id="cc5ea-167">Delete attachments by using EWS in Exchange</span></span>](how-to-delete-attachments-by-using-ews-in-exchange.md)
    
## <a name="see-also"></a><span data-ttu-id="cc5ea-168">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="cc5ea-168">See also</span></span>
<span data-ttu-id="cc5ea-169"><a name="bk_additionalresources"> </a></span><span class="sxs-lookup"><span data-stu-id="cc5ea-169"></span></span>

- [<span data-ttu-id="cc5ea-170">Développer des clients de service web pour Exchange</span><span class="sxs-lookup"><span data-stu-id="cc5ea-170">Develop web service clients for Exchange</span></span>](develop-web-service-clients-for-exchange.md)
    
- [<span data-ttu-id="cc5ea-171">Dossiers et éléments dans EWS dans Exchange</span><span class="sxs-lookup"><span data-stu-id="cc5ea-171">Folders and items in EWS in Exchange</span></span>](folders-and-items-in-ews-in-exchange.md)
    
- [<span data-ttu-id="cc5ea-172">Courrier électronique et les services EWS d'Exchange</span><span class="sxs-lookup"><span data-stu-id="cc5ea-172">Email and EWS in Exchange</span></span>](email-and-ews-in-exchange.md)
    

