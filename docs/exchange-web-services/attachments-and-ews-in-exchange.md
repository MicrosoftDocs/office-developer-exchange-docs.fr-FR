---
title: Pièces jointes et EWS dans Exchange
manager: sethgros
ms.date: 7/11/2016
ms.audience: Developer
ms.assetid: 8e4289a4-ec9d-4502-9854-c593c95d5f98
description: Découvrez les pièces jointes et comment votre API managée EWS ou EWS dans le client Exchange les représente.
localization_priority: Priority
ms.openlocfilehash: d37fef9ea14a3b42a0eed0240724fe69c8531c93
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/03/2020
ms.locfileid: "44528488"
---
# <a name="attachments-and-ews-in-exchange"></a><span data-ttu-id="1bac9-103">Pièces jointes et EWS dans Exchange</span><span class="sxs-lookup"><span data-stu-id="1bac9-103">Attachments and EWS in Exchange</span></span>

<span data-ttu-id="1bac9-104">Découvrez les pièces jointes et comment votre API managée EWS ou EWS dans le client Exchange les représente.</span><span class="sxs-lookup"><span data-stu-id="1bac9-104">Learn about attachments and how your EWS Managed API or EWS in Exchange client represents them.</span></span>
  
<span data-ttu-id="1bac9-105">En règle générale, les pièces jointes sont associées à des éléments de courrier électronique, mais en fait, tous les éléments EWS (messages électroniques, éléments de calendrier, contacts, tâches) peuvent inclure des pièces jointes.</span><span class="sxs-lookup"><span data-stu-id="1bac9-105">Usually, attachments are associated with email items, but in fact, all EWS items — email messages, calendar items, contacts, tasks — can include attachments.</span></span>
  
## <a name="types-of-attachments"></a><span data-ttu-id="1bac9-106">Types de pièces jointes</span><span class="sxs-lookup"><span data-stu-id="1bac9-106">Types of attachments</span></span>

<span data-ttu-id="1bac9-107">EWS classe les pièces jointes en deux groupes : fichiers joints et pièces jointes.</span><span class="sxs-lookup"><span data-stu-id="1bac9-107">EWS categorizes attachments into two groups: file attachments and item attachments.</span></span>
  
- <span data-ttu-id="1bac9-108">**Pièces jointes d’éléments :** Des [éléments EWS](folders-and-items-in-ews-in-exchange.md)fortement typés, tels que des messages électroniques et des éléments de calendrier, qui sont attachés à un autre élément EWS fortement typé.</span><span class="sxs-lookup"><span data-stu-id="1bac9-108">**Item attachments:** Strongly-typed [EWS items](folders-and-items-in-ews-in-exchange.md), such as email messages and calendar items, that are attached to another strongly-typed EWS item.</span></span> <span data-ttu-id="1bac9-109">Tout élément fortement typé pouvant être créé à l’aide de l’API managée EWS ou EWS peut être utilisé en tant que pièce jointe d’un élément.</span><span class="sxs-lookup"><span data-stu-id="1bac9-109">Any strongly-typed item that can be created by using the EWS Managed API or EWS can be used as an item attachment.</span></span> <span data-ttu-id="1bac9-110">Le contenu d’une pièce jointe d’un élément est l’élément fortement typé, qui permet d’accéder facilement à toutes ses propriétés.</span><span class="sxs-lookup"><span data-stu-id="1bac9-110">The content of an item attachment is the strongly-typed item, which provides easy access to all its properties.</span></span> <span data-ttu-id="1bac9-111">Les pièces jointes d’élément peuvent avoir leurs propres pièces jointes, de sorte qu’une hiérarchie de pièces jointes d’éléments (ou l’imbrication de pièces jointes) est possible.</span><span class="sxs-lookup"><span data-stu-id="1bac9-111">Item attachments can have their own item attachments, so a hierarchy of item attachments (or nesting of attachments) is possible.</span></span>
    
- <span data-ttu-id="1bac9-112">**Pièces jointes :** Tout fichier, par exemple un fichier. txt,. jpg,. zip,. pdf ou même un fichier. msg.</span><span class="sxs-lookup"><span data-stu-id="1bac9-112">**File attachments:** Any file, such as a .txt, .jpg, .zip, .pdf, or even a .msg file.</span></span> <span data-ttu-id="1bac9-113">Une pièce jointe possède seulement quelques propriétés, dont l’une est le contenu encodé en base 64 du fichier.</span><span class="sxs-lookup"><span data-stu-id="1bac9-113">A file attachment only has a few properties, one of which is the base-64 encoded content of the file.</span></span> 
    
- <span data-ttu-id="1bac9-114">**Pièces jointes de référence :** Toute pièce jointe référencée par un fournisseur de fichiers, telle qu’un fichier situé dans le Cloud.</span><span class="sxs-lookup"><span data-stu-id="1bac9-114">**Reference attachments:** Any attachment that is referenced by a file provider, such as a file located in the cloud.</span></span> <span data-ttu-id="1bac9-115">Une pièce jointe peut provenir de plusieurs fournisseurs.</span><span class="sxs-lookup"><span data-stu-id="1bac9-115">An attachment can be from multiple providers.</span></span> 
    
<span data-ttu-id="1bac9-116">Lorsque vous ajoutez ou récupérez des pièces jointes à partir d’un élément, vous pouvez le faire différemment selon qu’il s’agit d’une pièce jointe de fichier ou d’une pièce jointe d’élément.</span><span class="sxs-lookup"><span data-stu-id="1bac9-116">When you add or retrieve attachments from an item, you'll do it differently depending on whether it's a file attachment or an item attachment.</span></span> <span data-ttu-id="1bac9-117">Par exemple, pour ajouter un fichier en pièce jointe à un élément, vous pouvez simplement transmettre l’emplacement du fichier.</span><span class="sxs-lookup"><span data-stu-id="1bac9-117">For example, to add a file attachment to an item, you can just pass in the location of the file.</span></span> <span data-ttu-id="1bac9-118">Pour ajouter un élément existant en tant que pièce jointe d’un élément, vous devez copier les propriétés ou le contenu MIME de l’élément existant vers une nouvelle pièce jointe d’élément ; vous ne pouvez pas établir une liaison avec l’élément existant.</span><span class="sxs-lookup"><span data-stu-id="1bac9-118">To add an existing item as an item attachment, you actually have to copy the properties or the MIME content of the existing item to a new item attachment; you can't just bind to the existing item.</span></span> <span data-ttu-id="1bac9-119">Il est donc important d’établir une distinction entre les deux types de pièces jointes.</span><span class="sxs-lookup"><span data-stu-id="1bac9-119">So distinguishing between the two types of attachments is important.</span></span> <span data-ttu-id="1bac9-120">Vous trouverez plus d’informations sur les différences entre les pièces jointes d’éléments et les pièces jointes dans les articles [de cette section](#bk_inthissection).</span><span class="sxs-lookup"><span data-stu-id="1bac9-120">More details about the differences between item attachments and file attachments are discussed in the articles [In this section](#bk_inthissection).</span></span>
  
## <a name="how-are-attachments-represented-programmatically"></a><span data-ttu-id="1bac9-121">Comment les pièces jointes sont-elles représentées par programme ?</span><span class="sxs-lookup"><span data-stu-id="1bac9-121">How are attachments represented programmatically?</span></span>

<span data-ttu-id="1bac9-122">Les pièces jointes sont stockées dans une collection sur l’élément EWS.</span><span class="sxs-lookup"><span data-stu-id="1bac9-122">Attachments are stored in a collection on the EWS item.</span></span> <span data-ttu-id="1bac9-123">La collection attachments est constituée de pièces jointes de fichiers et/ou de pièces jointes d’éléments.</span><span class="sxs-lookup"><span data-stu-id="1bac9-123">The attachments collection is made up of file attachments and/or item attachments.</span></span> <span data-ttu-id="1bac9-124">Les métadonnées relatives à la collection de pièces jointes sont disponibles lorsque vous obtenez un élément à l’aide de l’élément de l’API managée EWS [. bind](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.bind%28v=exchg.80%29.aspx) ou de l’opération EWS [GetItem](https://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) , mais les appels supplémentaires sont requis pour récupérer le contenu des pièces jointes.</span><span class="sxs-lookup"><span data-stu-id="1bac9-124">Metadata about the attachment collection is available when you get an item by using the EWS Managed API [Item.Bind](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.bind%28v=exchg.80%29.aspx) method or the EWS [GetItem](https://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) operation, but additional calls are required to actually retrieve the contents of the attachments.</span></span> 
  
<span data-ttu-id="1bac9-125">**Tableau 1. Métadonnées d’élément relatives aux pièces jointes**</span><span class="sxs-lookup"><span data-stu-id="1bac9-125">**Table 1. Item metadata about attachments**</span></span>

|<span data-ttu-id="1bac9-126">**Entité de métadonnées**</span><span class="sxs-lookup"><span data-stu-id="1bac9-126">**Metadata entity**</span></span>|<span data-ttu-id="1bac9-127">**Propriété de l’API managée EWS**</span><span class="sxs-lookup"><span data-stu-id="1bac9-127">**EWS Managed API property**</span></span>|<span data-ttu-id="1bac9-128">**Élément EWS**</span><span class="sxs-lookup"><span data-stu-id="1bac9-128">**EWS element**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="1bac9-129">Indicateur d’attachement (ne marque pas les pièces jointes en ligne)</span><span class="sxs-lookup"><span data-stu-id="1bac9-129">Attachment indicator (does not flag inline attachments)</span></span>  <br/> |[<span data-ttu-id="1bac9-130">Item. HasAttachments</span><span class="sxs-lookup"><span data-stu-id="1bac9-130">Item.HasAttachments</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.hasattachments%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="1bac9-131">HasAttachments</span><span class="sxs-lookup"><span data-stu-id="1bac9-131">HasAttachments</span></span>](https://msdn.microsoft.com/library/538b7a85-11d7-4daa-8458-09b540760e8b%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="1bac9-132">Collection de pièces jointes</span><span class="sxs-lookup"><span data-stu-id="1bac9-132">Attachment collection</span></span>  <br/> |[<span data-ttu-id="1bac9-133">Item. Attachments</span><span class="sxs-lookup"><span data-stu-id="1bac9-133">Item.Attachments</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.attachments%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="1bac9-134">Attachments</span><span class="sxs-lookup"><span data-stu-id="1bac9-134">Attachments</span></span>](https://msdn.microsoft.com/library/b470e614-34bb-44f0-8790-7ddbdcbbd29d%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="1bac9-135">ID des pièces jointes</span><span class="sxs-lookup"><span data-stu-id="1bac9-135">Attachment ID</span></span>  <br/> |[<span data-ttu-id="1bac9-136">Attachment.Id</span><span class="sxs-lookup"><span data-stu-id="1bac9-136">Attachment.Id</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.attachment.id%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="1bac9-137">AttachmentId</span><span class="sxs-lookup"><span data-stu-id="1bac9-137">AttachmentId</span></span>](https://msdn.microsoft.com/library/55a5fd77-60d1-40fa-8144-770600cedc6a%28Office.15%29.aspx) <br/> |
   
<span data-ttu-id="1bac9-138">**Tableau 2. Entités de pièces jointes**</span><span class="sxs-lookup"><span data-stu-id="1bac9-138">**Table 2. Attachment entities**</span></span>

|<span data-ttu-id="1bac9-139">**Type de pièce jointe**</span><span class="sxs-lookup"><span data-stu-id="1bac9-139">**Attachment type**</span></span>|<span data-ttu-id="1bac9-140">**Classe d’API managée EWS**</span><span class="sxs-lookup"><span data-stu-id="1bac9-140">**EWS Managed API class**</span></span>|<span data-ttu-id="1bac9-141">**Élément EWS**</span><span class="sxs-lookup"><span data-stu-id="1bac9-141">**EWS element**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="1bac9-142">Pièce jointe</span><span class="sxs-lookup"><span data-stu-id="1bac9-142">File attachment</span></span>  <br/> |[<span data-ttu-id="1bac9-143">FileAttachment</span><span class="sxs-lookup"><span data-stu-id="1bac9-143">FileAttachment</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.fileattachment%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="1bac9-144">FileAttachment</span><span class="sxs-lookup"><span data-stu-id="1bac9-144">FileAttachment</span></span>](https://msdn.microsoft.com/library/3ecea174-73d1-47fd-8917-6065cef1d565%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="1bac9-145">Pièce jointe d’élément</span><span class="sxs-lookup"><span data-stu-id="1bac9-145">Item attachment</span></span>  <br/> |[<span data-ttu-id="1bac9-146">ItemAttachment</span><span class="sxs-lookup"><span data-stu-id="1bac9-146">ItemAttachment</span></span>](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.itemattachment%28v=exchg.80%29.aspx) <br/> [<span data-ttu-id="1bac9-147">ItemAttachment\<TItem\></span><span class="sxs-lookup"><span data-stu-id="1bac9-147">ItemAttachment\<TItem\></span></span>](https://msdn.microsoft.com/library/dd635165%28v=exchg.80%29.aspx) <br/> |[<span data-ttu-id="1bac9-148">ItemAttachment</span><span class="sxs-lookup"><span data-stu-id="1bac9-148">ItemAttachment</span></span>](https://msdn.microsoft.com/library/089ee599-f45e-46f5-a18a-5cfb3d2851ff%28Office.15%29.aspx) <br/> |
|<span data-ttu-id="1bac9-149">Pièce jointe de référence</span><span class="sxs-lookup"><span data-stu-id="1bac9-149">Reference attachment</span></span>  <br/> |[<span data-ttu-id="1bac9-150">ComplexType ReferenceAttachmentType (EWS)</span><span class="sxs-lookup"><span data-stu-id="1bac9-150">ReferenceAttachmentType complexType (EWS)</span></span>](https://msdn.microsoft.com/library/18bfa012-e903-d7f3-528a-31ccceb65463%28Office.15%29.aspx) <br/> |[<span data-ttu-id="1bac9-151">ReferenceAttachment</span><span class="sxs-lookup"><span data-stu-id="1bac9-151">ReferenceAttachment</span></span>](https://msdn.microsoft.com/library/b9bde862-6b75-4a81-8033-00a47be4dc2f%28Office.15%29.aspx) <br/> |
   
## <a name="inline-attachments"></a><span data-ttu-id="1bac9-152">Pièces jointes en ligne</span><span class="sxs-lookup"><span data-stu-id="1bac9-152">Inline attachments</span></span>

<span data-ttu-id="1bac9-153">Les pièces jointes incorporées sont une race spéciale.</span><span class="sxs-lookup"><span data-stu-id="1bac9-153">Inline attachments are a special breed of attachment.</span></span> <span data-ttu-id="1bac9-154">Les pièces jointes et les pièces jointes des éléments peuvent être des pièces jointes.</span><span class="sxs-lookup"><span data-stu-id="1bac9-154">Both file attachments and item attachments can be inline attachments.</span></span> <span data-ttu-id="1bac9-155">Une pièce jointe incorporée apparaît dans le corps du contenu et conserve sa position par rapport au reste du contenu de l’élément.</span><span class="sxs-lookup"><span data-stu-id="1bac9-155">An inline attachment appears as part of the body content and retains its position relative to the rest of the content in the item.</span></span> 
  
<span data-ttu-id="1bac9-156">Une pièce jointe est une pièce jointe incorporée si la propriété [IsInline](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.attachment.isinline%28v=exchg.80%29.aspx) de l’API managée EWS ou l’élément [IsInline](https://msdn.microsoft.com/library/5e7712c8-372a-4a16-be64-360c5ff3961a%28Office.15%29.aspx) EWS est définie sur true.</span><span class="sxs-lookup"><span data-stu-id="1bac9-156">An attachment is an inline attachment if the EWS Managed API [IsInline](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.attachment.isinline%28v=exchg.80%29.aspx) property or the EWS [IsInline](https://msdn.microsoft.com/library/5e7712c8-372a-4a16-be64-360c5ff3961a%28Office.15%29.aspx) element is set to true.</span></span> <span data-ttu-id="1bac9-157">Les pièces jointes incorporées utilisent les éléments et les propriétés facultatifs suivants pour identifier l’emplacement d’une pièce jointe incorporée :</span><span class="sxs-lookup"><span data-stu-id="1bac9-157">Inline attachments use the following optional properties and elements to identify the location of an inline attachment:</span></span> 
  
- <span data-ttu-id="1bac9-158">API managée EWS — propriétés [contentid](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.attachment.contentid%28v=exchg.80%29.aspx) ou [ContentLocation](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.attachment.contentlocation%28v=exchg.80%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="1bac9-158">EWS Managed API — [ContentId](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.attachment.contentid%28v=exchg.80%29.aspx) or [ContentLocation](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.attachment.contentlocation%28v=exchg.80%29.aspx) properties.</span></span> 
    
- <span data-ttu-id="1bac9-159">EWS — élément [contentid](https://msdn.microsoft.com/library/bc59100d-6079-414b-a6e0-7c15feaa3184%28Office.15%29.aspx) ou [ContentLocation](https://msdn.microsoft.com/library/d91cf587-24e3-4c13-8784-5ca29787cca7%28Office.15%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="1bac9-159">EWS — [ContentId](https://msdn.microsoft.com/library/bc59100d-6079-414b-a6e0-7c15feaa3184%28Office.15%29.aspx) or [ContentLocation](https://msdn.microsoft.com/library/d91cf587-24e3-4c13-8784-5ca29787cca7%28Office.15%29.aspx) element.</span></span> 
    
<span data-ttu-id="1bac9-160">Notez que la propriété [HasAttachments](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.hasattachments%28v=exchg.80%29.aspx) de l’API managée EWS et l’élément EWS [HasAttachments](https://msdn.microsoft.com/library/538b7a85-11d7-4daa-8458-09b540760e8b%28Office.15%29.aspx) ne reflètent pas l’existence de pièces jointes incorporées, et c’est pourquoi les pièces jointes incorporées sont également appelées pièces jointes masquées.</span><span class="sxs-lookup"><span data-stu-id="1bac9-160">Note that the EWS Managed API [HasAttachments](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.item.hasattachments%28v=exchg.80%29.aspx) property and the EWS [HasAttachments](https://msdn.microsoft.com/library/538b7a85-11d7-4daa-8458-09b540760e8b%28Office.15%29.aspx) element do not reflect the existence of inline attachments, and that's why inline attachments are also called hidden attachments.</span></span> <span data-ttu-id="1bac9-161">Par conséquent, si vous définissez la propriété [IsInline](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.attachment.isinline%28v=exchg.80%29.aspx) de l’API managée EWS ou l’élément [IsInline](https://msdn.microsoft.com/library/5e7712c8-372a-4a16-be64-360c5ff3961a%28Office.15%29.aspx) EWS sur true, et que l’élément n’a pas d’autres pièces jointes, **HasAttachments** prend la valeur false.</span><span class="sxs-lookup"><span data-stu-id="1bac9-161">So if you set the EWS Managed API [IsInline](https://msdn.microsoft.com/library/microsoft.exchange.webservices.data.attachment.isinline%28v=exchg.80%29.aspx) property or the EWS [IsInline](https://msdn.microsoft.com/library/5e7712c8-372a-4a16-be64-360c5ff3961a%28Office.15%29.aspx) element to true, and the item has no other attachments, **HasAttachments** will be set to false.</span></span> <span data-ttu-id="1bac9-162">Si votre client utilise **HasAttachments** pour remplir un indicateur ou une icône de pièce jointe dans un message électronique, sachez que l’icône n’apparaît pas pour les messages électroniques contenant des pièces jointes incorporées.</span><span class="sxs-lookup"><span data-stu-id="1bac9-162">If your client uses **HasAttachments** to populate an attachment indicator or icon on an email, be aware that the icon will not appear for emails with inline attachments.</span></span> 
  
## <a name="in-this-section"></a><span data-ttu-id="1bac9-163">Dans cette section</span><span class="sxs-lookup"><span data-stu-id="1bac9-163">In this section</span></span>
<span data-ttu-id="1bac9-164"><a name="bk_inthissection"> </a></span><span class="sxs-lookup"><span data-stu-id="1bac9-164"><a name="bk_inthissection"> </a></span></span>

- [<span data-ttu-id="1bac9-165">Récupérer des pièces jointes à l’aide d’EWS dans Exchange</span><span class="sxs-lookup"><span data-stu-id="1bac9-165">Add attachments by using EWS in Exchange</span></span>](how-to-add-attachments-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="1bac9-166">Récupérer des pièces jointes à l’aide d’EWS dans Exchange</span><span class="sxs-lookup"><span data-stu-id="1bac9-166">Get attachments by using EWS in Exchange</span></span>](how-to-get-attachments-by-using-ews-in-exchange.md)
    
- [<span data-ttu-id="1bac9-167">Supprimer des pièces jointes à l'aide de EWS dans Exchange</span><span class="sxs-lookup"><span data-stu-id="1bac9-167">Delete attachments by using EWS in Exchange</span></span>](how-to-delete-attachments-by-using-ews-in-exchange.md)
    
## <a name="see-also"></a><span data-ttu-id="1bac9-168">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="1bac9-168">See also</span></span>
<span data-ttu-id="1bac9-169"><a name="bk_additionalresources"> </a></span><span class="sxs-lookup"><span data-stu-id="1bac9-169"><a name="bk_additionalresources"> </a></span></span>

- [<span data-ttu-id="1bac9-170">Développer des clients de service web pour Exchange</span><span class="sxs-lookup"><span data-stu-id="1bac9-170">Develop web service clients for Exchange</span></span>](develop-web-service-clients-for-exchange.md)
    
- [<span data-ttu-id="1bac9-171">Dossiers et éléments dans EWS dans Exchange</span><span class="sxs-lookup"><span data-stu-id="1bac9-171">Folders and items in EWS in Exchange</span></span>](folders-and-items-in-ews-in-exchange.md)
    
- [<span data-ttu-id="1bac9-172">Courrier électronique et les services EWS d'Exchange</span><span class="sxs-lookup"><span data-stu-id="1bac9-172">Email and EWS in Exchange</span></span>](email-and-ews-in-exchange.md)
    

