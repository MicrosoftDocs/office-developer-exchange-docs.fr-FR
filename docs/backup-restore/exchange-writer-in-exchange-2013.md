---
title: Enregistreur Exchange dans Exchange 2013
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: ec126433-9f0a-46ec-a685-ff4af2f97bc1
description: Trouvez des informations sur le rédacteur Exchange dans Exchange 2013 pour les opérations de sauvegarde et de restauration.
ms.openlocfilehash: 44270a87c38b08d274d389fa6e46f3864da13ed2
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/03/2020
ms.locfileid: "44452887"
---
# <a name="exchange-writer-in-exchange-2013"></a><span data-ttu-id="74e78-103">Enregistreur Exchange dans Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="74e78-103">Exchange writer in Exchange 2013</span></span>

<span data-ttu-id="74e78-104">Trouvez des informations sur le rédacteur Exchange dans Exchange 2013 pour les opérations de sauvegarde et de restauration.</span><span class="sxs-lookup"><span data-stu-id="74e78-104">Find information about the Exchange writer in Exchange 2013 for backup and restore operations.</span></span> 
  
<span data-ttu-id="74e78-105">**S’applique à :** Exchange Server 2013</span><span class="sxs-lookup"><span data-stu-id="74e78-105">**Applies to:** Exchange Server 2013</span></span> 
  
<span data-ttu-id="74e78-106">Le rédacteur Exchange est responsable de la sauvegarde et de la restauration des bases de données Exchange Server 2013 actives.</span><span class="sxs-lookup"><span data-stu-id="74e78-106">The Exchange writer is responsible for the backup and restore of active Exchange Server 2013 databases.</span></span> <span data-ttu-id="74e78-107">L’enregistreur Exchange prend également en charge la fonctionnalité de sauvegarde pour une base de données sélectionnée où le cliché instantané est pris par rapport à l’instance répliquée de la base de données et des fichiers journaux des transactions.</span><span class="sxs-lookup"><span data-stu-id="74e78-107">The Exchange writer also supports backup functionality for a selected database where the shadow copy is taken against the replicated instance of the database and transaction log files.</span></span> 
  
## <a name="overview-of-the-exchange-writer"></a><span data-ttu-id="74e78-108">Vue d’ensemble du rédacteur Exchange</span><span class="sxs-lookup"><span data-stu-id="74e78-108">Overview of the Exchange writer</span></span>
<span data-ttu-id="74e78-109"><a name="bk_Overview"> </a></span><span class="sxs-lookup"><span data-stu-id="74e78-109"><a name="bk_Overview"> </a></span></span>

<span data-ttu-id="74e78-110">Exchange 2013 inclut des fonctionnalités de mobilité de base de données, qui permettent de répliquer les bases de données entre différents serveurs Exchange afin d’améliorer la disponibilité de la base de données et la résilience de site.</span><span class="sxs-lookup"><span data-stu-id="74e78-110">Exchange 2013 includes database mobility features, which enable databases to be replicated among different Exchange servers to improve database availability and site resilience.</span></span> <span data-ttu-id="74e78-111">Les autres copies de base de données dans un groupe de disponibilité de base de données (DAG) fournissent une opportunité intéressante pour les sauvegardes Exchange afin d’utiliser les ressources supplémentaires disponibles dans l’emplacement de la copie.</span><span class="sxs-lookup"><span data-stu-id="74e78-111">The other database copies in a Database Availability Group (DAG) provide a valuable opportunity for Exchange backups to use the extra resources that are available at the copy location.</span></span> <span data-ttu-id="74e78-112">En outre, étant donné que la copie au lieu du maître de base de données actif est sauvegardée, la copie peut être indisponible pendant une période plus longue.</span><span class="sxs-lookup"><span data-stu-id="74e78-112">In addition, because the copy instead of the active database master is backed up, the copy can be unavailable during the backup for a longer period of time.</span></span> 
  
<span data-ttu-id="74e78-113">Le rédacteur Exchange coordonne avec les services Exchange (fonctionnant pour le compte du demandeur) pour préparer les fichiers de base de données pour les sauvegardes, geler l’activité e/s résultant des transactions Exchange avant de sauvegarder la base de données, puis libérez et tronquez les fichiers journaux une fois la sauvegarde terminée.</span><span class="sxs-lookup"><span data-stu-id="74e78-113">The Exchange writer coordinates with the Exchange services (operating on behalf of the requester) to prepare the database files for backups, freeze the IO activity resulting from Exchange transactions before backing up the database, and then unfreeze and truncate log files after the backup is complete.</span></span>
  
<span data-ttu-id="74e78-114">Pendant une restauration, votre application de sauvegarde et de restauration demande à l’enregistreur Exchange de se coordonner avec la Banque d’identité Exchange (opérant au nom du demandeur) pour vérifier les cibles de restauration, renommer le fichier de base de données si nécessaire, puis relire les journaux de transactions en fonction des besoins.</span><span class="sxs-lookup"><span data-stu-id="74e78-114">During a restore, your backup and restore application instructs the Exchange writer to coordinate with the Exchange store (operating on behalf of the requester) to verify the restore targets, rename the database file if necessary, and then replay the transaction logs as needed.</span></span> <span data-ttu-id="74e78-115">L’enregistreur Exchange prend en charge à la fois les sauvegardes et les restaurations.</span><span class="sxs-lookup"><span data-stu-id="74e78-115">The Exchange writer supports both backups and restores.</span></span>
  
<span data-ttu-id="74e78-116">L’enregistreur Exchange est disponible sur tous les serveurs Exchange sur lesquels le rôle serveur de boîtes aux lettres est installé.</span><span class="sxs-lookup"><span data-stu-id="74e78-116">The Exchange writer is available on any Exchange server that has the Mailbox server role installed.</span></span> 
  
## <a name="exchange-writer-configuration-settings"></a><span data-ttu-id="74e78-117">Paramètres de configuration du rédacteur Exchange</span><span class="sxs-lookup"><span data-stu-id="74e78-117">Exchange writer configuration settings</span></span>
<span data-ttu-id="74e78-118"><a name="bk_ExchangeWriterConfig"> </a></span><span class="sxs-lookup"><span data-stu-id="74e78-118"><a name="bk_ExchangeWriterConfig"> </a></span></span>

<span data-ttu-id="74e78-119">L’enregistreur Exchange pour VSS utilise un grand nombre de paramètres et de valeurs qui doivent être correctement définis et conservés pendant les opérations de sauvegarde et de restauration.</span><span class="sxs-lookup"><span data-stu-id="74e78-119">The Exchange writer for VSS uses a variety of settings and values that must be set correctly and preserved during backup and restore operations.</span></span> <span data-ttu-id="74e78-120">Ces paramètres de configuration sont stockés dans le document de métadonnées de l’enregistreur Exchange.</span><span class="sxs-lookup"><span data-stu-id="74e78-120">These configuration settings are stored in the Exchange writer metadata document.</span></span> <span data-ttu-id="74e78-121">Si votre application de sauvegarde ne conserve pas ces paramètres, il se peut que vous rencontriez des erreurs inattendues lors de la tentative de sauvegarde de vos bases de données Exchange.</span><span class="sxs-lookup"><span data-stu-id="74e78-121">If your backup application does not preserve these settings, you might experience unexpected errors when you attempt to back up your Exchange databases.</span></span> 
  
<span data-ttu-id="74e78-122">Le tableau suivant répertorie les interfaces VSS qui exposent les métadonnées sur les composants de votre sauvegarde de base de données.</span><span class="sxs-lookup"><span data-stu-id="74e78-122">The following table lists the VSS interfaces that expose metadata about the components of your database backup.</span></span> <span data-ttu-id="74e78-123">Ces interfaces sont requises pour obtenir le document de métadonnées d’écriture Exchange qui est utilisé pour effectuer une sauvegarde de la Banque d’Exchange.</span><span class="sxs-lookup"><span data-stu-id="74e78-123">These interfaces are required to get the Exchange writer metadata document that is used to perform a backup of the Exchange store.</span></span>
  
<span data-ttu-id="74e78-124">**Tableau 1. Interfaces VSS**</span><span class="sxs-lookup"><span data-stu-id="74e78-124">**Table 1. VSS interfaces**</span></span>

|<span data-ttu-id="74e78-125">**Interface VSS**</span><span class="sxs-lookup"><span data-stu-id="74e78-125">**VSS interface**</span></span>|<span data-ttu-id="74e78-126">**Description**</span><span class="sxs-lookup"><span data-stu-id="74e78-126">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="74e78-127">IVssWMComponent</span><span class="sxs-lookup"><span data-stu-id="74e78-127">IVssWMComponent</span></span>  <br/> |<span data-ttu-id="74e78-128">Autorise l’accès aux informations de composants stockées dans l’enregistreur Exchange.</span><span class="sxs-lookup"><span data-stu-id="74e78-128">Allows access to component information stored in the Exchange writer.</span></span>  <br/> |
|<span data-ttu-id="74e78-129">IVssExamineWriterMetadata</span><span class="sxs-lookup"><span data-stu-id="74e78-129">IVssExamineWriterMetadata</span></span>  <br/> |<span data-ttu-id="74e78-130">Permet à l’application de demande de sauvegarde et de restauration d’examiner les métadonnées de l’enregistreur Exchange.</span><span class="sxs-lookup"><span data-stu-id="74e78-130">Allows the requesting backup and restore application to examine the metadata of the Exchange writer.</span></span> <span data-ttu-id="74e78-131">Le document de métadonnées d’enregistreur Exchange contient les valeurs et les paramètres propres à Exchange 2013 que l’application de sauvegarde et de restauration qui demande doit pouvoir spécifier correctement les composants appropriés pour la sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="74e78-131">The Exchange writer metadata document contains Exchange 2013-specific values and parameters that the requesting backup and restore application requires so that it can correctly specify the appropriate components for backup.</span></span>  <br/> |
|<span data-ttu-id="74e78-132">IVssComponent</span><span class="sxs-lookup"><span data-stu-id="74e78-132">IVssComponent</span></span>  <br/> |<span data-ttu-id="74e78-133">Contient les méthodes permettant d’examiner et de modifier des informations sur les composants contenus dans le document des composants de sauvegarde d’un demandeur.</span><span class="sxs-lookup"><span data-stu-id="74e78-133">Contains methods for examining and modifying information about components contained in a requester's Backup Components Document.</span></span> <span data-ttu-id="74e78-134">Les objets ne peuvent être obtenus que pour les composants qui ont été explicitement ajoutés à ce document par la méthode [IVssBackupComponents :: AddComponent](https://msdn.microsoft.com/library/windows/desktop/aa382646%28v=vs.85%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="74e78-134">Objects can only be obtained for those components that have been explicitly added to this document by the [IVssBackupComponents::AddComponent](https://msdn.microsoft.com/library/windows/desktop/aa382646%28v=vs.85%29.aspx) method.</span></span>  <br/> |
|<span data-ttu-id="74e78-135">IVssBackupComponents</span><span class="sxs-lookup"><span data-stu-id="74e78-135">IVssBackupComponents</span></span>  <br/> |<span data-ttu-id="74e78-136">Utilisé par l’application de sauvegarde et de restauration pour interroger l’enregistreur Exchange sur l’état des fichiers et exécuter les opérations de sauvegarde et de restauration.</span><span class="sxs-lookup"><span data-stu-id="74e78-136">Used by the requesting backup and restore application to poll the Exchange writer about file status and to run backup and restore operations.</span></span> <span data-ttu-id="74e78-137">La méthode [IVssBackupComponents :: SetBackupState](https://msdn.microsoft.com/library/windows/desktop/aa382833%28v=vs.85%29.aspx) définit si l’opération de sauvegarde est une sauvegarde complète, copie, incrémentielle ou différentielle.</span><span class="sxs-lookup"><span data-stu-id="74e78-137">The [IVssBackupComponents::SetBackupState ](https://msdn.microsoft.com/library/windows/desktop/aa382833%28v=vs.85%29.aspx) method defines whether the backup operation is a full, copy, incremental, or differential backup.</span></span> <span data-ttu-id="74e78-138">La méthode [IVssBackupComponents :: AddRestoreSubcomponent](https://msdn.microsoft.com/library/windows/desktop/aa382649%28v=vs.85%29.aspx) définit les sous-composants d’une base de données Exchange 2013 pouvant être sélectionnée pour une opération de restauration.</span><span class="sxs-lookup"><span data-stu-id="74e78-138">The [IVssBackupComponents::AddRestoreSubcomponent](https://msdn.microsoft.com/library/windows/desktop/aa382649%28v=vs.85%29.aspx) method defines the subcomponents of an Exchange 2013 database that can be selected for a restore operation.</span></span>  <br/> |
   
<span data-ttu-id="74e78-139">Dans le système de fichiers Windows Server, une base de données Exchange 2013 est stockée sous la forme d’un fichier de base de données unique avec l’extension *. edb. Le rédacteur Exchange expose le fichier *. edb en tant que composant de base de données, tandis que les journaux de transactions (*. log) et les fichiers de point de contrôle (*. chk) sont combinés en un seul composant, connu sous le titre du composant de journal.</span><span class="sxs-lookup"><span data-stu-id="74e78-139">Within the Windows Server file system, an Exchange 2013 database is stored as a single database file with an extension *.edb. The Exchange writer exposes the *.edb as the database component, while transaction logs (*.log) and checkpoint files (*.chk) are combined into a single component, referred to as the log component.</span></span> <span data-ttu-id="74e78-140">Pour plus d’informations sur les fichiers de base de données Exchange, consultez la rubrique [concepts de sauvegarde et de restauration pour Exchange 2013](backup-and-restore-concepts-for-exchange-2013.md).</span><span class="sxs-lookup"><span data-stu-id="74e78-140">For more information about Exchange database files, see [Backup and restore concepts for Exchange 2013](backup-and-restore-concepts-for-exchange-2013.md).</span></span>
  
## <a name="interactions-between-the-exchange-writer-vss-and-vss-requesters"></a><span data-ttu-id="74e78-141">Interactions entre le rédacteur Exchange, VSS et les demandeurs VSS</span><span class="sxs-lookup"><span data-stu-id="74e78-141">Interactions between the Exchange writer, VSS, and VSS requesters</span></span>
<span data-ttu-id="74e78-142"><a name="bk_interactions"> </a></span><span class="sxs-lookup"><span data-stu-id="74e78-142"><a name="bk_interactions"> </a></span></span>

<span data-ttu-id="74e78-143">Les interactions de haut niveau entre VSS, le rédacteur Exchange et Exchange 2013 pendant les opérations de sauvegarde sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="74e78-143">The high-level interaction between the VSS, the Exchange writer, and Exchange 2013 during backup operations is as follows:</span></span>
  
1. <span data-ttu-id="74e78-144">Le programme (ou l'agent) de sauvegarde exécute une tâche planifiée.</span><span class="sxs-lookup"><span data-stu-id="74e78-144">The backup program (or agent) runs a scheduled job.</span></span> 
    
2. <span data-ttu-id="74e78-145">Le demandeur VSS dans l’application de sauvegarde et de restauration envoie une commande au service VSS pour prendre un cliché instantané des bases de données Exchange 2013 sélectionnées.</span><span class="sxs-lookup"><span data-stu-id="74e78-145">The VSS requester in the backup and restore application sends a command to VSS to take a shadow copy of the selected Exchange 2013 databases.</span></span> 
    
3. <span data-ttu-id="74e78-146">VSS communique avec le rédacteur Exchange pour préparer une sauvegarde de capture instantanée.</span><span class="sxs-lookup"><span data-stu-id="74e78-146">VSS communicates with the Exchange writer to prepare for a snapshot backup.</span></span> <span data-ttu-id="74e78-147">Exchange 2013 interdit les actions administratives sur les bases de données, vérifie les dépendances de volume et interrompt toutes les opérations d’écriture sur l’instance sélectionnée de la base de données et des fichiers journaux de transactions tout en autorisant l’accès en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="74e78-147">Exchange 2013 prohibits administrative actions against the databases, checks volume dependencies, and suspends all write operations to selected instance of the database and transaction log files while allowing read-only access.</span></span> 
    
4. <span data-ttu-id="74e78-148">VSS communique avec le fournisseur de stockage approprié pour créer un cliché instantané du volume de stockage qui contient les bases de données Exchange 2013.</span><span class="sxs-lookup"><span data-stu-id="74e78-148">VSS communicates with the appropriate storage provider to create a shadow copy of the storage volume that contains the Exchange 2013 databases.</span></span> 
    
5. <span data-ttu-id="74e78-149">VSS publie Exchange 2013 pour reprendre les opérations ordinaires.</span><span class="sxs-lookup"><span data-stu-id="74e78-149">VSS releases Exchange 2013 to resume ordinary operations.</span></span> 
    
6. <span data-ttu-id="74e78-150">Le demandeur VSS vérifie la cohérence physique du jeu de sauvegarde avant de signaler que la sauvegarde a réussi.</span><span class="sxs-lookup"><span data-stu-id="74e78-150">The VSS requester verifies the physical consistency of the backup set prior to signaling that the backup was successful.</span></span> <span data-ttu-id="74e78-151">Exchange 2013 tronque les journaux de transactions (si la base de données fait partie d’un DAG, la troncation de journal est répliquée dans toutes les copies) et enregistre l’heure de la dernière sauvegarde de la base de données.</span><span class="sxs-lookup"><span data-stu-id="74e78-151">Exchange 2013 truncates the transaction logs (if the database is part of a DAG, log truncation is replicated among all the copies) and records the time of the last backup for the database.</span></span>
    
<span data-ttu-id="74e78-152">VSS sérialise les interactions des demandeurs avec le rédacteur Exchange en commençant par la méthode [OnPrepareBackup](https://msdn.microsoft.com/library/windows/desktop/aa381571%28v=vs.85%29.aspx) et en terminant par la méthode [OnPostSnapshot](https://msdn.microsoft.com/library/windows/desktop/aa381568%28v=vs.85%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="74e78-152">VSS serializes requesters' interaction with the Exchange writer starting with the [OnPrepareBackup](https://msdn.microsoft.com/library/windows/desktop/aa381571%28v=vs.85%29.aspx) method and ending with the [OnPostSnapshot](https://msdn.microsoft.com/library/windows/desktop/aa381568%28v=vs.85%29.aspx) method.</span></span> <span data-ttu-id="74e78-153">En règle générale, la majorité du temps que le rédacteur Exchange passe à travailler avec le cliché instantané se produit après la méthode **OnPostSnapshot** , lorsque la cohérence du cliché instantané est vérifiée avant la fin des sauvegardes.</span><span class="sxs-lookup"><span data-stu-id="74e78-153">Typically, the majority of time the Exchange writer spends working with the shadow copy occurs after the **OnPostSnapshot** method, when the consistency of the shadow copy is verified prior to completion of the backups.</span></span> <span data-ttu-id="74e78-154">L’enregistreur Exchange prend en charge les sauvegardes parallèles entre **OnPostSnapshot** et [OnBackupComplete](https://msdn.microsoft.com/library/windows/desktop/aa381557%28v=vs.85%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="74e78-154">The Exchange writer supports parallel backups between **OnPostSnapshot** and [OnBackupComplete](https://msdn.microsoft.com/library/windows/desktop/aa381557%28v=vs.85%29.aspx).</span></span>
  
<span data-ttu-id="74e78-155">Exchange 2013 n’autorise pas les sauvegardes simultanées de la même base de données.</span><span class="sxs-lookup"><span data-stu-id="74e78-155">Exchange 2013 does not allow concurrent backups of the same database.</span></span> <span data-ttu-id="74e78-156">Une seule opération de sauvegarde peut être exécutée sur une base de données donnée à la fois.</span><span class="sxs-lookup"><span data-stu-id="74e78-156">Only one backup job can run against a given database at one time.</span></span> <span data-ttu-id="74e78-157">Lorsque la sauvegarde est en cours d’exécution, la Banque d’Exchange place la base de données dans un état de sauvegarde en cours.</span><span class="sxs-lookup"><span data-stu-id="74e78-157">When the backup is running, the Exchange store puts the database in a backup-in-progress state.</span></span> <span data-ttu-id="74e78-158">Cet État en mémoire est effacé au terme du processus de sauvegarde ou au redémarrage du service.</span><span class="sxs-lookup"><span data-stu-id="74e78-158">This in-memory state is cleared either at the completion of the backup process or when the service is restarted.</span></span> <span data-ttu-id="74e78-159">L’état de sauvegarde en mémoire et les données associées sont perdus lorsque le service qui héberge l’enregistreur Exchange est redémarré, lorsque le système d’exploitation est redémarré ou lorsqu’un basculement de cluster se produit.</span><span class="sxs-lookup"><span data-stu-id="74e78-159">The in-memory backup-in-progress state and its associated data are lost when the service that hosts the Exchange writer is restarted, when the operating system is restarted, or when a cluster failover occurs.</span></span> <span data-ttu-id="74e78-160">L’un de ces événements entraîne l’échec du travail de sauvegarde.</span><span class="sxs-lookup"><span data-stu-id="74e78-160">Any of these events will cause the backup job to fail.</span></span>
  
<span data-ttu-id="74e78-161">La troncation du fichier journal des transactions initiées par une sauvegarde est déclenchée en fonction du type de sauvegarde à effectuer.</span><span class="sxs-lookup"><span data-stu-id="74e78-161">Backup-initiated transaction log file truncation is triggered based on the type of backup to be performed.</span></span> <span data-ttu-id="74e78-162">Dans les configurations non DAG, l’enregistreur Exchange tronque les fichiers journaux des transactions à la fin des sauvegardes complètes ou incrémentielles réussies.</span><span class="sxs-lookup"><span data-stu-id="74e78-162">In non-DAG configurations, the Exchange writer will truncate the transaction log files at the completion of successful full or incremental backups.</span></span> <span data-ttu-id="74e78-163">Dans les configurations répliquées DAG, la troncation des journaux est retardée par le service de réplication jusqu’à ce que tous les fichiers journaux nécessaires soient relus dans toutes les autres copies.</span><span class="sxs-lookup"><span data-stu-id="74e78-163">In DAG replicated configurations, log truncation will be delayed by the replication service until all necessary log files are replayed into all other copies.</span></span> <span data-ttu-id="74e78-164">Le service de réplication supprime les fichiers journaux sauvegardés des chemins d’accès au fichier journal actifs et de copie une fois qu’il a vérifié que les fichiers journaux ont bien été appliqués à la base de données de copie et à la base de données active et que le point de contrôle des copies de base de données a passé les fichiers journaux à supprimer.</span><span class="sxs-lookup"><span data-stu-id="74e78-164">The replication service will delete the backed up log files both from the active and the copy log file paths after it verifies that the log files have successfully been applied to the copy database and both active database and the database copies checkpoint has passed the log files to be deleted.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="74e78-165">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="74e78-165">See also</span></span>

- [<span data-ttu-id="74e78-166">Journaux de transaction et fichiers de point de contrôle pour la sauvegarde et la restauration dans Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="74e78-166">Transaction logs and checkpoint files for backup and restore in Exchange 2013</span></span>](transaction-logs-and-checkpoint-files-for-backup-and-restore-in-exchange.md)
    
- [<span data-ttu-id="74e78-167">Concepts de sauvegarde et de restauration pour Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="74e78-167">Backup and restore concepts for Exchange 2013</span></span>](backup-and-restore-concepts-for-exchange-2013.md)
    

