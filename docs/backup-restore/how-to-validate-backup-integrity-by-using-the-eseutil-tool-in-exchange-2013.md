---
title: Valider l’intégrité de la sauvegarde à l’aide de l’outil Eseutil dans Exchange 2013
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: b0d325ba-4482-4ca2-9a69-c890f985b206
description: Découvrez comment utiliser l’outil de ligne de commande Eseutil pour valider une sauvegarde de la Banque d’informations Exchange.
ms.openlocfilehash: e8f1a46e2d94729ae5586861317312e277216d63
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/03/2020
ms.locfileid: "44452796"
---
#  <a name="validate-backup-integrity-by-using-the-eseutil-tool-in-exchange-2013"></a><span data-ttu-id="c5607-103">Valider l’intégrité de la sauvegarde à l’aide de l’outil Eseutil dans Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="c5607-103">Validate backup integrity by using the Eseutil tool in Exchange 2013</span></span>

<span data-ttu-id="c5607-104">Découvrez comment utiliser l’outil de ligne de commande Eseutil pour valider une sauvegarde de la Banque d’informations Exchange.</span><span class="sxs-lookup"><span data-stu-id="c5607-104">Find out how to use the Eseutil command-line tool to validate a backup of the Exchange store.</span></span> 
  
<span data-ttu-id="c5607-105">**S’applique à :** Exchange Server 2013</span><span class="sxs-lookup"><span data-stu-id="c5607-105">**Applies to:** Exchange Server 2013</span></span> 
  
<span data-ttu-id="c5607-106">Étant donné que le service VSS (Volume Shadow Copy Service) peut créer des sauvegardes alors qu’Exchange continue d’écrire dans la base de données, le serveur ne touche pas toutes les pages et effectue les vérifications de cohérence nécessaires.</span><span class="sxs-lookup"><span data-stu-id="c5607-106">Because the Volume Shadow Copy Service (VSS) can create backups while Exchange continues to write to the database, the server does not touch all the pages and perform the necessary consistency checks.</span></span> <span data-ttu-id="c5607-107">Pour cette raison, toute application de sauvegarde et de restauration qui utilise VSS doit vérifier la cohérence de capture instantanée.</span><span class="sxs-lookup"><span data-stu-id="c5607-107">For this reason, any backup and restore application that uses VSS must verify snapshot consistency.</span></span> <span data-ttu-id="c5607-108">Exchange Server 2013 prend en charge les deux méthodes suivantes pour vérifier la cohérence des captures instantanées :</span><span class="sxs-lookup"><span data-stu-id="c5607-108">Exchange Server 2013 supports the following two methods for checking snapshot consistency:</span></span> 
  
- <span data-ttu-id="c5607-109">API CHKSGFILES</span><span class="sxs-lookup"><span data-stu-id="c5607-109">The CHKSGFILES API</span></span>
    
- <span data-ttu-id="c5607-110">Outil de ligne de commande Eseutil</span><span class="sxs-lookup"><span data-stu-id="c5607-110">The Eseutil command-line tool</span></span>
    
<span data-ttu-id="c5607-111">Nous vous recommandons d’utiliser l’API CHKSGFILES, car il est plus facile pour l’application de sauvegarde de détecter, de diagnostiquer et de signaler les erreurs détectées lors de la vérification de cohérence CHKSGFILES.</span><span class="sxs-lookup"><span data-stu-id="c5607-111">We recommend that you use the CHKSGFILES API because it is easier for the backup application to detect, diagnose, and report errors that are found during the CHKSGFILES consistency check.</span></span> <span data-ttu-id="c5607-112">Pour plus d’informations sur l’utilisation de l’API CHKSGFILES, consultez la rubrique validation de l' [intégrité de la sauvegarde à l’aide de l’API CHKSGFILES dans Exchange 2013](how-to-validate-backup-integrity-by-using-the-chksgfiles-api-in-exchange.md).</span><span class="sxs-lookup"><span data-stu-id="c5607-112">For information about how to use the CHKSGFILES API, see [Validate backup integrity by using the CHKSGFILES API in Exchange 2013](how-to-validate-backup-integrity-by-using-the-chksgfiles-api-in-exchange.md).</span></span>
  
## <a name="running-the-eseutil-tool"></a><span data-ttu-id="c5607-113">Exécution de l’outil Eseutil</span><span class="sxs-lookup"><span data-stu-id="c5607-113">Running the Eseutil tool</span></span>

<span data-ttu-id="c5607-114">Pour vérifier la cohérence des captures instantanées, exécutez la commande Eseutil sur la base de données et les fichiers journaux identifiés dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="c5607-114">To check the snapshot consistency, run the eseutil command against the database and log files that are identified in the following table.</span></span> 
  
<span data-ttu-id="c5607-115">**Tableau 1. Commandes Eseutil. exe pour chaque type de sauvegarde**</span><span class="sxs-lookup"><span data-stu-id="c5607-115">**Table 1. Eseutil.exe commands for each backup type**</span></span>

|<span data-ttu-id="c5607-116">**Type de fichier/type de sauvegarde**</span><span class="sxs-lookup"><span data-stu-id="c5607-116">**File type/backup type**</span></span>|<span data-ttu-id="c5607-117">**Sauvegarde complète**</span><span class="sxs-lookup"><span data-stu-id="c5607-117">**Full backup**</span></span>|<span data-ttu-id="c5607-118">**Copie de sauvegarde**</span><span class="sxs-lookup"><span data-stu-id="c5607-118">**Copy backup**</span></span>|<span data-ttu-id="c5607-119">**Sauvegarde incrémentielle**</span><span class="sxs-lookup"><span data-stu-id="c5607-119">**Incremental backup**</span></span>|<span data-ttu-id="c5607-120">**Sauvegarde différentielle**</span><span class="sxs-lookup"><span data-stu-id="c5607-120">**Differential backup**</span></span>|
|:-----|:-----|:-----|:-----|:-----|
|<span data-ttu-id="c5607-121">. edb</span><span class="sxs-lookup"><span data-stu-id="c5607-121">.edb</span></span>  <br/> |<span data-ttu-id="c5607-122">"Eseutil/k/i"</span><span class="sxs-lookup"><span data-stu-id="c5607-122">"eseutil /k /i"</span></span>  <br/> |<span data-ttu-id="c5607-123">"Eseutil/k/i"</span><span class="sxs-lookup"><span data-stu-id="c5607-123">"eseutil /k /i"</span></span>  <br/> |<span data-ttu-id="c5607-124">Non applicable</span><span class="sxs-lookup"><span data-stu-id="c5607-124">Not applicable</span></span>  <br/> |<span data-ttu-id="c5607-125">Non applicable</span><span class="sxs-lookup"><span data-stu-id="c5607-125">Not applicable</span></span>  <br/> |
|<span data-ttu-id="c5607-126">. log</span><span class="sxs-lookup"><span data-stu-id="c5607-126">.log</span></span>  <br/> |<span data-ttu-id="c5607-127">« Eseutil/k » (1)</span><span class="sxs-lookup"><span data-stu-id="c5607-127">"eseutil /k" (1)</span></span>  <br/> |<span data-ttu-id="c5607-128">« Eseutil/k » (1)</span><span class="sxs-lookup"><span data-stu-id="c5607-128">"eseutil /k" (1)</span></span>  <br/> |<span data-ttu-id="c5607-129">"Eseutil/k" (2)</span><span class="sxs-lookup"><span data-stu-id="c5607-129">"eseutil /k" (2)</span></span>  <br/> |<span data-ttu-id="c5607-130">"Eseutil/k" (2)</span><span class="sxs-lookup"><span data-stu-id="c5607-130">"eseutil /k" (2)</span></span>  <br/> |
   
> [!NOTE]
> <span data-ttu-id="c5607-131">Vous n’avez pas besoin d’exécuter la commande Eseutil sur les fichiers. stm et. chk.</span><span class="sxs-lookup"><span data-stu-id="c5607-131">You do not need to run the eseutil command against .stm and .chk files.</span></span> 
  
<span data-ttu-id="c5607-132">Tous les fichiers journaux dont le numéro de génération est supérieur ou égal au numéro de génération du fichier journal de point de contrôle sont requis afin de récupérer une base de données de captures instantanées.</span><span class="sxs-lookup"><span data-stu-id="c5607-132">All the log files that have a log file generation number that is equal to or greater than the generation number of the checkpoint log file are required in order to recover a snapshot database.</span></span> <span data-ttu-id="c5607-133">S’il existe, le fichier journal actuel (Enn. log) est également requis pour la récupération de la base de données.</span><span class="sxs-lookup"><span data-stu-id="c5607-133">If it exists, the current log file (Enn.log) is also required for database recovery.</span></span> <span data-ttu-id="c5607-134">Si l’un des fichiers journaux requis échoue à la vérification de cohérence, le demandeur doit s’assurer que l’état du composant de sauvegarde est défini sur FALSe avant d’appeler la méthode [BackupComplete](https://msdn.microsoft.com/library/windows/desktop/aa382651%28v=vs.85%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="c5607-134">If any of the required log files fail the consistency check, the requester must make sure that the status of the backup component is set to FALSE before it calls the [BackupComplete](https://msdn.microsoft.com/library/windows/desktop/aa382651%28v=vs.85%29.aspx) method.</span></span> <span data-ttu-id="c5607-135">Pour identifier le fichier journal de point de contrôle, exécutez Eseutil. exe sur le fichier de point de contrôle de capture instantanée et analysez la sortie pour « point de contrôle : ».</span><span class="sxs-lookup"><span data-stu-id="c5607-135">To identify the checkpoint log file, run Eseutil.exe against the snapshot checkpoint file and parse the output for "Checkpoint:."</span></span> <span data-ttu-id="c5607-136">L’exemple suivant montre comment exécuter Eseutil. exe avec un fichier de point de contrôle.</span><span class="sxs-lookup"><span data-stu-id="c5607-136">The following example shows how to run Eseutil.exe against a checkpoint file.</span></span> 
  
```cpp
c:\eseutil.exe /mk E01.chk
Checkpoint: (0x20, 9D, 187)
```

<span data-ttu-id="c5607-137">La deuxième ligne de l’exemple est la valeur renvoyée, où 0x20 est le numéro de génération de journal hexadécimal du fichier journal de point de contrôle.</span><span class="sxs-lookup"><span data-stu-id="c5607-137">The second line in the example is the return value, where 0x20 is the hexadecimal log generation number of the checkpoint log file.</span></span> <span data-ttu-id="c5607-138">Dans cet exemple, tous les fichiers journaux, y compris E01000020. log et supérieur, ne doivent pas être endommagés afin de récupérer la base de données de capture instantanée, même si la base de données elle-même a déjà passé la vérification de cohérence physique.</span><span class="sxs-lookup"><span data-stu-id="c5607-138">In this example, any log files, including E01000020.log and greater, must not be corrupt in order to recover the snapshot database, even if the database itself has already passed the physical consistency check.</span></span>
  
<span data-ttu-id="c5607-139">Tous les fichiers journaux d’un jeu de sauvegarde incrémentielle ou différentiel sont requis pour la récupération de la base de données.</span><span class="sxs-lookup"><span data-stu-id="c5607-139">All log files in an incremental or differential backup set are required for database recovery.</span></span> <span data-ttu-id="c5607-140">Vous pouvez vérifier la cohérence d’une séquence de journal en exécutant eseutil. exe avec le préfixe du fichier journal.</span><span class="sxs-lookup"><span data-stu-id="c5607-140">You can check the consistency of a log sequence by running Eseutil.exe against the log file prefix.</span></span> <span data-ttu-id="c5607-141">L’exemple suivant montre comment exécuter des vérifications de cohérence sur tous les fichiers au format E01xxxxx. log sur un chemin d’accès donné.</span><span class="sxs-lookup"><span data-stu-id="c5607-141">The following example shows how to run consistency checks against all the files of the form E01xxxxx.log on a given path.</span></span>
  
```cpp
c:\eseutil /k E01
```

## <a name="checking-the-eseutilexe-output"></a><span data-ttu-id="c5607-142">Vérification de la sortie d’Eseutil. exe</span><span class="sxs-lookup"><span data-stu-id="c5607-142">Checking the Eseutil.exe output</span></span>

<span data-ttu-id="c5607-143">Le demandeur doit vérifier que toutes les valeurs d’erreur de sortie ERRORLEVEL renvoyées sont non négatives.</span><span class="sxs-lookup"><span data-stu-id="c5607-143">The requester must verify that all the exit ERRORLEVEL error values that are returned are nonnegative.</span></span> <span data-ttu-id="c5607-144">Pour plus d’informations sur les valeurs ERRORLEVEL, voir [Reference for Common Eseutil Errors](https://technet.microsoft.com/library/aa996759%28v=exchg.80%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="c5607-144">For information about ERRORLEVEL values, see [Reference for Common Eseutil Errors](https://technet.microsoft.com/library/aa996759%28v=exchg.80%29.aspx).</span></span> <span data-ttu-id="c5607-145">Pour afficher le ERRORLEVEL à partir de la ligne de commande, tapez « echo% errorlevel% » une fois l’exécution de Eseutil. exe terminée.</span><span class="sxs-lookup"><span data-stu-id="c5607-145">To see the ERRORLEVEL at the command line, type "echo %errorlevel%" after Eseutil.exe finishes running.</span></span> <span data-ttu-id="c5607-146">Un ERRORLEVEL négatif indique qu’un ou plusieurs fichiers sont endommagés.</span><span class="sxs-lookup"><span data-stu-id="c5607-146">A negative ERRORLEVEL indicates that one or more files is corrupted.</span></span>
  
<span data-ttu-id="c5607-147">Avant que le demandeur appelle la méthode **BackupComplete** , il doit s’assurer que l’état du composant de sauvegarde reflète le résultat de la vérification de cohérence.</span><span class="sxs-lookup"><span data-stu-id="c5607-147">Before the requester calls the **BackupComplete** method, it must make sure that the status of the backup component reflects the result of the consistency check.</span></span> <span data-ttu-id="c5607-148">Si une corruption a été détectée, l’État prend la valeur FALSe ; Si aucune altération n’a été détectée, l’État est TRUE.</span><span class="sxs-lookup"><span data-stu-id="c5607-148">If any corruption was found, the status will be FALSE; if no corruption was found, the status will be TRUE.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="c5607-149">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="c5607-149">See also</span></span>

- [<span data-ttu-id="c5607-150">Valider l’intégrité de la sauvegarde à l’aide de l’API CHKSGFILES dans Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="c5607-150">Validate backup integrity by using the CHKSGFILES API in Exchange 2013</span></span>](how-to-validate-backup-integrity-by-using-the-chksgfiles-api-in-exchange.md)
- [<span data-ttu-id="c5607-151">Créer des applications de sauvegarde et de restauration pour Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="c5607-151">Build backup and restore applications for Exchange 2013</span></span>](build-backup-and-restore-applications-for-exchange-2013.md)
- [<span data-ttu-id="c5607-152">Référence de classe fonction cchksgfiles</span><span class="sxs-lookup"><span data-stu-id="c5607-152">CChkSGFiles class reference</span></span>](cchksgfiles-class-reference.md)
- [<span data-ttu-id="c5607-153">Concepts de sauvegarde et de restauration pour Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="c5607-153">Backup and restore concepts for Exchange 2013</span></span>](backup-and-restore-concepts-for-exchange-2013.md)
    

