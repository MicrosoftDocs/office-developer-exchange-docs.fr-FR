---
title: Valider l’intégrité des sauvegardes à l’aide l’outil Eseutil dans Exchange 2013
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: b0d325ba-4482-4ca2-9a69-c890f985b206
description: Découvrez comment utiliser l’outil de ligne de commande Eseutil pour valider une sauvegarde de la banque d’informations Exchange.
ms.openlocfilehash: 03c4c23d433418911240bbe7c337308a989f3739
ms.sourcegitcommit: 34041125dc8c5f993b21cebfc4f8b72f0fd2cb6f
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/11/2018
ms.locfileid: "19754741"
---
#  <a name="validate-backup-integrity-by-using-the-eseutil-tool-in-exchange-2013"></a><span data-ttu-id="ce3bc-103">Valider l’intégrité des sauvegardes à l’aide l’outil Eseutil dans Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="ce3bc-103">Validate backup integrity by using the Eseutil tool in Exchange 2013</span></span>

<span data-ttu-id="ce3bc-104">Découvrez comment utiliser l’outil de ligne de commande Eseutil pour valider une sauvegarde de la banque d’informations Exchange.</span><span class="sxs-lookup"><span data-stu-id="ce3bc-104">Find out how to use the Eseutil command-line tool to validate a backup of the Exchange store.</span></span> 
  
<span data-ttu-id="ce3bc-105">**S’applique à :** Exchange Server 2013</span><span class="sxs-lookup"><span data-stu-id="ce3bc-105">**Applies to:** Exchange Server 2013</span></span> 
  
<span data-ttu-id="ce3bc-106">Étant donné que le Volume Shadow Copy Service (VSS) peut créer des sauvegardes pendant que Exchange continue à écrire dans la base de données, le serveur ne pas toutes les pages et effectuer les vérifications de cohérence nécessaires.</span><span class="sxs-lookup"><span data-stu-id="ce3bc-106">Because the Volume Shadow Copy Service (VSS) can create backups while Exchange continues to write to the database, the server does not touch all the pages and perform the necessary consistency checks.</span></span> <span data-ttu-id="ce3bc-107">Pour cette raison, n’importe quelle application de sauvegarde et de restauration qui utilise le service VSS doit vérifier la cohérence de la capture instantanée.</span><span class="sxs-lookup"><span data-stu-id="ce3bc-107">For this reason, any backup and restore application that uses VSS must verify snapshot consistency.</span></span> <span data-ttu-id="ce3bc-108">Exchange Server 2013 prend en charge les deux méthodes suivantes pour la vérification de cohérence de la capture instantanée :</span><span class="sxs-lookup"><span data-stu-id="ce3bc-108">Exchange Server 2013 supports the following two methods for checking snapshot consistency:</span></span> 
  
- <span data-ttu-id="ce3bc-109">L’API CHKSGFILES</span><span class="sxs-lookup"><span data-stu-id="ce3bc-109">The CHKSGFILES API</span></span>
    
- <span data-ttu-id="ce3bc-110">L’outil de ligne de commande Eseutil</span><span class="sxs-lookup"><span data-stu-id="ce3bc-110">The Eseutil command-line tool</span></span>
    
<span data-ttu-id="ce3bc-111">Nous vous recommandons d’utiliser l’API CHKSGFILES, car il est plus facile pour l’application de sauvegarde détecter, diagnostiquer et signaler les erreurs rencontrées lors de la cohérence CHKSGFILES vérifier.</span><span class="sxs-lookup"><span data-stu-id="ce3bc-111">We recommend that you use the CHKSGFILES API because it is easier for the backup application to detect, diagnose, and report errors that are found during the CHKSGFILES consistency check.</span></span> <span data-ttu-id="ce3bc-112">Pour plus d’informations sur la façon d’utiliser l’API CHKSGFILES, voir [l’intégrité des sauvegardes de valider en utilisant l’API CHKSGFILES dans Exchange 2013](how-to-validate-backup-integrity-by-using-the-chksgfiles-api-in-exchange.md).</span><span class="sxs-lookup"><span data-stu-id="ce3bc-112">For information about how to use the CHKSGFILES API, see [Validate backup integrity by using the CHKSGFILES API in Exchange 2013](how-to-validate-backup-integrity-by-using-the-chksgfiles-api-in-exchange.md).</span></span>
  
## <a name="running-the-eseutil-tool"></a><span data-ttu-id="ce3bc-113">Exécution de l’outil Eseutil</span><span class="sxs-lookup"><span data-stu-id="ce3bc-113">Running the Eseutil tool</span></span>

<span data-ttu-id="ce3bc-114">Pour vérifier la cohérence de la capture instantanée, exécutez la commande eseutil par rapport aux base de données et les fichiers journaux qui sont identifiés dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="ce3bc-114">To check the snapshot consistency, run the eseutil command against the database and log files that are identified in the following table.</span></span> 
  
<span data-ttu-id="ce3bc-115">**Le tableau 1. Commandes Eseutil.exe pour chaque type de sauvegarde**</span><span class="sxs-lookup"><span data-stu-id="ce3bc-115">**Table 1. Eseutil.exe commands for each backup type**</span></span>

|<span data-ttu-id="ce3bc-116">**Type de sauvegarde/de type de fichier**</span><span class="sxs-lookup"><span data-stu-id="ce3bc-116">**File type/backup type**</span></span>|<span data-ttu-id="ce3bc-117">**Sauvegarde complète**</span><span class="sxs-lookup"><span data-stu-id="ce3bc-117">**Full backup**</span></span>|<span data-ttu-id="ce3bc-118">**Copie de sauvegarde**</span><span class="sxs-lookup"><span data-stu-id="ce3bc-118">**Copy backup**</span></span>|<span data-ttu-id="ce3bc-119">**Sauvegarde incrémentielle**</span><span class="sxs-lookup"><span data-stu-id="ce3bc-119">**Incremental backup**</span></span>|<span data-ttu-id="ce3bc-120">**Sauvegarde différentielle**</span><span class="sxs-lookup"><span data-stu-id="ce3bc-120">**Differential backup**</span></span>|
|:-----|:-----|:-----|:-----|:-----|
|<span data-ttu-id="ce3bc-121">.edb</span><span class="sxs-lookup"><span data-stu-id="ce3bc-121">.edb</span></span>  <br/> |<span data-ttu-id="ce3bc-122">« eseutil /k /i »</span><span class="sxs-lookup"><span data-stu-id="ce3bc-122">"eseutil /k /i"</span></span>  <br/> |<span data-ttu-id="ce3bc-123">« eseutil /k /i »</span><span class="sxs-lookup"><span data-stu-id="ce3bc-123">"eseutil /k /i"</span></span>  <br/> |<span data-ttu-id="ce3bc-124">Not applicable</span><span class="sxs-lookup"><span data-stu-id="ce3bc-124">Not applicable</span></span>  <br/> |<span data-ttu-id="ce3bc-125">Not applicable</span><span class="sxs-lookup"><span data-stu-id="ce3bc-125">Not applicable</span></span>  <br/> |
|<span data-ttu-id="ce3bc-126">.log</span><span class="sxs-lookup"><span data-stu-id="ce3bc-126">.log</span></span>  <br/> |<span data-ttu-id="ce3bc-127">« eseutil /k » (1)</span><span class="sxs-lookup"><span data-stu-id="ce3bc-127">"eseutil /k" (1)</span></span>  <br/> |<span data-ttu-id="ce3bc-128">« eseutil /k » (1)</span><span class="sxs-lookup"><span data-stu-id="ce3bc-128">"eseutil /k" (1)</span></span>  <br/> |<span data-ttu-id="ce3bc-129">« eseutil /k » (2)</span><span class="sxs-lookup"><span data-stu-id="ce3bc-129">"eseutil /k" (2)</span></span>  <br/> |<span data-ttu-id="ce3bc-130">« eseutil /k » (2)</span><span class="sxs-lookup"><span data-stu-id="ce3bc-130">"eseutil /k" (2)</span></span>  <br/> |
   
> [!NOTE]
> <span data-ttu-id="ce3bc-131">Il est inutile d’exécuter la commande eseutil sur les fichiers .stm et .chk.</span><span class="sxs-lookup"><span data-stu-id="ce3bc-131">You do not need to run the eseutil command against .stm and .chk files.</span></span> 
  
<span data-ttu-id="ce3bc-132">Tous les fichiers journaux qui ont une génération du fichier journal numéro qui est égale ou supérieure à la génération du numéro du fichier journal au point de contrôle sont requis afin de récupérer une base de données de capture instantanée.</span><span class="sxs-lookup"><span data-stu-id="ce3bc-132">All the log files that have a log file generation number that is equal to or greater than the generation number of the checkpoint log file are required in order to recover a snapshot database.</span></span> <span data-ttu-id="ce3bc-133">S’il existe, le fichier journal actuel (Enn.log) est également requis pour la récupération de la base de données.</span><span class="sxs-lookup"><span data-stu-id="ce3bc-133">If it exists, the current log file (Enn.log) is also required for database recovery.</span></span> <span data-ttu-id="ce3bc-134">Si un des fichiers journaux requis échoue la vérification de cohérence, le demandeur devez vous assurer que l’état du composant de sauvegarde est défini sur FALSE avant d’appeler la méthode [BackupComplete](http://msdn.microsoft.com/en-us/library/windows/desktop/aa382651%28v=vs.85%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="ce3bc-134">If any of the required log files fail the consistency check, the requester must make sure that the status of the backup component is set to FALSE before it calls the [BackupComplete](http://msdn.microsoft.com/en-us/library/windows/desktop/aa382651%28v=vs.85%29.aspx) method.</span></span> <span data-ttu-id="ce3bc-135">Pour identifier le fichier journal de point de contrôle, exécutez Eseutil.exe sur le fichier de point de contrôle de capture instantanée et analyser la sortie pour » au point de contrôle :. »</span><span class="sxs-lookup"><span data-stu-id="ce3bc-135">To identify the checkpoint log file, run Eseutil.exe against the snapshot checkpoint file and parse the output for "Checkpoint:."</span></span> <span data-ttu-id="ce3bc-136">L’exemple suivant montre comment exécuter Eseutil.exe sur un fichier de point de contrôle.</span><span class="sxs-lookup"><span data-stu-id="ce3bc-136">The following example shows how to run Eseutil.exe against a checkpoint file.</span></span> 
  
```cpp
c:\eseutil.exe /mk E01.chk
Checkpoint: (0x20, 9D, 187)
```

<span data-ttu-id="ce3bc-137">La deuxième ligne dans l’exemple est la valeur de retour, où 0 x 20 est le numéro de génération de journal hexadécimal du fichier journal au point de contrôle.</span><span class="sxs-lookup"><span data-stu-id="ce3bc-137">The second line in the example is the return value, where 0x20 is the hexadecimal log generation number of the checkpoint log file.</span></span> <span data-ttu-id="ce3bc-138">Dans cet exemple, les fichiers journaux, y compris E01000020.log et supérieur, doit n'être pas endommagé afin de récupérer la base de données de capture instantanée, même si la base de données est déjà passée la vérification de cohérence physique.</span><span class="sxs-lookup"><span data-stu-id="ce3bc-138">In this example, any log files, including E01000020.log and greater, must not be corrupt in order to recover the snapshot database, even if the database itself has already passed the physical consistency check.</span></span>
  
<span data-ttu-id="ce3bc-139">Tous les fichiers journaux dans un jeu de sauvegarde incrémentiel ou différentiel sont requis pour la récupération de base de données.</span><span class="sxs-lookup"><span data-stu-id="ce3bc-139">All log files in an incremental or differential backup set are required for database recovery.</span></span> <span data-ttu-id="ce3bc-140">Vous pouvez vérifier la cohérence d’une séquence de journal en exécutant Eseutil.exe sur le préfixe du fichier journal.</span><span class="sxs-lookup"><span data-stu-id="ce3bc-140">You can check the consistency of a log sequence by running Eseutil.exe against the log file prefix.</span></span> <span data-ttu-id="ce3bc-141">L’exemple suivant montre comment exécuter les vérifications de cohérence sur tous les fichiers au format E01xxxxx.log sur un chemin d’accès donné.</span><span class="sxs-lookup"><span data-stu-id="ce3bc-141">The following example shows how to run consistency checks against all the files of the form E01xxxxx.log on a given path.</span></span>
  
```cpp
c:\eseutil /k E01
```

## <a name="checking-the-eseutilexe-output"></a><span data-ttu-id="ce3bc-142">Vérification de la sortie Eseutil.exe</span><span class="sxs-lookup"><span data-stu-id="ce3bc-142">Checking the Eseutil.exe output</span></span>

<span data-ttu-id="ce3bc-143">Le demandeur doit vérifier que toutes les quitter niveau d’erreur Erreur valeurs renvoyées sont non négatifs.</span><span class="sxs-lookup"><span data-stu-id="ce3bc-143">The requester must verify that all the exit ERRORLEVEL error values that are returned are nonnegative.</span></span> <span data-ttu-id="ce3bc-144">Pour plus d’informations sur les valeurs de niveau d’erreur, voir [référence des erreurs courantes de Eseutil](http://technet.microsoft.com/en-us/library/aa996759%28v=exchg.80%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="ce3bc-144">For information about ERRORLEVEL values, see [Reference for Common Eseutil Errors](http://technet.microsoft.com/en-us/library/aa996759%28v=exchg.80%29.aspx).</span></span> <span data-ttu-id="ce3bc-145">Pour afficher le niveau d’erreur à la ligne de commande, tapez « echo %errorlevel% » après la fin de Eseutil.exe.</span><span class="sxs-lookup"><span data-stu-id="ce3bc-145">To see the ERRORLEVEL at the command line, type "echo %errorlevel%" after Eseutil.exe finishes running.</span></span> <span data-ttu-id="ce3bc-146">Un niveau d’erreur négative indique qu’un ou plusieurs fichiers est endommagé.</span><span class="sxs-lookup"><span data-stu-id="ce3bc-146">A negative ERRORLEVEL indicates that one or more files is corrupted.</span></span>
  
<span data-ttu-id="ce3bc-147">Avant le demandeur appelle la méthode **BackupComplete** , il doit Assurez-vous que l’état du composant de sauvegarde reflète le résultat de la vérification de cohérence.</span><span class="sxs-lookup"><span data-stu-id="ce3bc-147">Before the requester calls the **BackupComplete** method, it must make sure that the status of the backup component reflects the result of the consistency check.</span></span> <span data-ttu-id="ce3bc-148">Si toute corruption a été trouvée, l’état sera FALSE ; Si aucune corruption a été trouvée, l’état est TRUE.</span><span class="sxs-lookup"><span data-stu-id="ce3bc-148">If any corruption was found, the status will be FALSE; if no corruption was found, the status will be TRUE.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="ce3bc-149">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="ce3bc-149">See also</span></span>

- [<span data-ttu-id="ce3bc-150">Valider l’intégrité des sauvegardes en utilisant l’API CHKSGFILES dans Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="ce3bc-150">Validate backup integrity by using the CHKSGFILES API in Exchange 2013</span></span>](how-to-validate-backup-integrity-by-using-the-chksgfiles-api-in-exchange.md)
- [<span data-ttu-id="ce3bc-151">Créer la sauvegarde et de restaurer des applications pour Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="ce3bc-151">Build backup and restore applications for Exchange 2013</span></span>](build-backup-and-restore-applications-for-exchange-2013.md)
- [<span data-ttu-id="ce3bc-152">Référence de classe CChkSGFiles</span><span class="sxs-lookup"><span data-stu-id="ce3bc-152">CChkSGFiles class reference</span></span>](cchksgfiles-class-reference.md)
- [<span data-ttu-id="ce3bc-153">Concepts de sauvegarde et de restauration pour Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="ce3bc-153">Backup and restore concepts for Exchange 2013</span></span>](backup-and-restore-concepts-for-exchange-2013.md)
    

